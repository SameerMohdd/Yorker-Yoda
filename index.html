<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yorker Yoda - PSL 2025 Match Predictor</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: white;
            padding: 20px;
            margin: 0;
            min-height: 100vh;
            color: #333;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 2px solid #B27F35;
        }
        header {
            text-align: center;
            background: linear-gradient(to right, #2B6735, #B27F35);
            padding: 20px;
            border-radius: 10px;
            color: white;
            position: relative;
            overflow: hidden;
            margin-bottom: 30px;
        }
        .header-content {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            position: relative;
            z-index: 2;
        }
        .cricket-icons {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 1;
            opacity: 0.1;
        }
        .cricket-icons::before {
            content: 'üèè';
            position: absolute;
            font-size: 80px;
            left: 20px;
            top: 50%;
            transform: translateY(-50%) rotate(-45deg);
        }
        .cricket-icons::after {
            content: 'üèè';
            position: absolute;
            font-size: 80px;
            right: 20px;
            top: 50%;
            transform: translateY(-50%) rotate(45deg);
        }
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .yoda-emoji {
            font-size: 60px;
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .yoda-emoji::before {
            content: 'üèè';
            font-size: 40px;
        }
        .yoda-emoji::after {
            content: 'üèè';
            font-size: 40px;
        }
        h1 {
            color: #fff;
            margin: 0;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .tagline {
            color: #fff;
            font-style: italic;
            margin: 5px 0;
            opacity: 0.9;
            font-size: 1.2em;
        }
        
        /* News Ticker */
        .news-ticker {
            background-color: #B27F35;
            color: #2B6735;
            padding: 10px 0;
            overflow: hidden;
            position: relative;
            font-weight: bold;
            border-top: 2px solid #2B6735;
            border-bottom: 2px solid #2B6735;
            margin-bottom: 20px;
        }
        
        .ticker-wrap {
            width: 100%;
            overflow: hidden;
        }
        
        .ticker-content {
            white-space: nowrap;
            animation: ticker 60s linear infinite;
            padding-left: 100%;
            display: inline-block;
        }
        
        @keyframes ticker {
            0% {
                transform: translateX(0);
            }
            100% {
                transform: translateX(-100%);
            }
        }
        
        /* Social Media Highlights */
        .social-highlights {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            padding: 20px;
            margin-bottom: 20px;
            border-top: 4px solid #2B6735;
        }
        
        .social-title {
            font-size: 18px;
            font-weight: bold;
            color: #2B6735;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .social-posts {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .social-post {
            background-color: #f9f9f9;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 3px solid #B27F35;
        }
        
        .post-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .post-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            overflow: hidden;
            margin-right: 10px;
            border: 2px solid #B27F35;
        }
        
        .post-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .post-info {
            flex: 1;
        }
        
        .post-author {
            font-weight: bold;
            margin-bottom: 2px;
            color: #2B6735;
        }
        
        .post-date {
            font-size: 12px;
            color: #777;
        }
        
        .post-content {
            margin-bottom: 10px;
        }
        
        .post-image {
            width: 100%;
            border-radius: 12px;
            margin-bottom: 10px;
            border: 1px solid #B27F35;
        }
        
        .post-actions {
            display: flex;
            gap: 15px;
            font-size: 14px;
            color: #777;
        }
        
        .post-action {
            display: flex;
            align-items: center;
            cursor: pointer;
        }
        
        .post-action i {
            margin-right: 5px;
        }
        
        /* Upcoming Matches */
        .upcoming-matches {
            margin-top: 30px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            padding: 20px;
            border-top: 4px solid #2B6735;
        }
        
        .match-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .match-item {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            padding: 15px;
            display: flex;
            flex-direction: column;
            border-left: 4px solid #2B6735;
        }
        
        .match-item-header {
            font-size: 14px;
            color: #777;
            margin-bottom: 10px;
        }
        
        .match-item-teams {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .match-item-team {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .match-item-logo {
            width: 40px;
            height: 40px;
            margin-bottom: 5px;
        }
        
        .match-item-logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        .match-item-name {
            font-size: 14px;
            font-weight: bold;
            text-transform: capitalize;
            color: #2B6735;
        }
        
        .match-item-vs {
            font-size: 14px;
            font-weight: bold;
            color: #B27F35;
        }
        
        .match-item-footer {
            text-align: center;
            margin-top: 10px;
            font-size: 14px;
            color: #2B6735;
            font-weight: bold;
        }
        .match-selector {
            margin: 20px 0;
            background: rgba(43, 103, 53, 0.1);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #B27F35;
        }
        .match-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
        }
        .match-button {
            background: white;
            border: 2px solid #B27F35;
            border-radius: 8px;
            padding: 12px 15px;
            font-size: 16px;
            color: #2B6735;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .match-button:hover {
            background: rgba(43, 103, 53, 0.1);
            border-color: #2B6735;
            transform: translateY(-2px);
        }
        .match-button.selected {
            background: rgba(43, 103, 53, 0.2);
            border-color: #2B6735;
            box-shadow: 0 3px 6px rgba(0,0,0,0.1);
        }
        .match-button-teams {
            font-weight: bold;
        }
        .match-button-details {
            font-size: 12px;
            color: #666;
        }
        .team-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            object-fit: contain;
        }
        .predict-btn {
            background: linear-gradient(to right, #B27F35, #8c6428);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 18px;
            cursor: pointer;
            position: relative;
            margin: 20px auto;
            display: block;
            transform: skew(-20deg);
            border-radius: 5px 50px 50px 5px;
            box-shadow: 3px 3px 6px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            width: 200px;
        }
        .predict-btn span {
            display: inline-block;
            transform: skew(20deg);
        }
        .predict-btn::after {
            content: '';
            position: absolute;
            right: -15px;
            top: 50%;
            transform: translateY(-50%);
            width: 15px;
            height: 80%;
            background: #8c6428;
            border-radius: 0 5px 5px 0;
        }
        .predict-btn:hover {
            transform: skew(-20deg) translateY(-2px);
            box-shadow: 4px 4px 8px rgba(0,0,0,0.3);
        }
        #match-details {
            margin-top: 20px;
            padding: 20px;
            background: linear-gradient(135deg, rgba(43, 103, 53, 0.1), rgba(178, 127, 53, 0.1));
            border-radius: 12px;
            border: 1px solid #B27F35;
        }
        
        #head-to-head {
            font-weight: bold;
            color: #2B6735;
        }
        .team-logos {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 20px 0;
        }
        .team-logo {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            border: 3px solid #B27F35;
            transition: transform 0.3s ease;
            overflow: hidden;
            background: white;
            padding: 5px;
        }
        .team-logo img {
            width: 90%;
            height: 90%;
            object-fit: contain;
        }
        .team-logo:hover {
            transform: scale(1.05);
        }
        .loading-spinner {
            display: none;
            width: 50px;
            height: 50px;
            border: 5px solid #B27F35;
            border-top: 5px solid #2B6735;
            border-radius: 50%;
            margin: 20px auto;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .prediction-result {
            margin-top: 20px;
            padding: 25px;
            background: linear-gradient(135deg, rgba(43, 103, 53, 0.1), rgba(178, 127, 53, 0.1));
            border-radius: 12px;
            border-left: 5px solid #2B6735;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            display: none;
        }
        .quote {
            font-style: italic;
            text-align: center;
            color: #555;
            margin: 20px 0;
            padding: 15px;
            background: rgba(255,255,255,0.8);
            border-radius: 8px;
            border: 1px solid #B27F35;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 20px;
        }
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            border: 1px solid #B27F35;
            transition: transform 0.3s ease;
        }
        .stat-card:hover {
            transform: translateY(-2px);
        }
        .stat-card h4 {
            margin: 0 0 10px 0;
            color: #2B6735;
            border-bottom: 2px solid #B27F35;
            padding-bottom: 5px;
        }
        #weather-selector {
            background: linear-gradient(135deg, rgba(43, 103, 53, 0.1), rgba(178, 127, 53, 0.1));
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #B27F35;
            margin-top: 20px;
            text-align: center;
        }
        #weather {
            background: white;
            border: 2px solid #B27F35;
            padding: 10px;
            width: 200px;
            border-radius: 8px;
            margin: 10px 0;
            color: #2B6735;
        }
        label {
            color: #2B6735;
            font-weight: bold;
        }
        
        /* Analysis Breakdown Styles */
        .tabs-container {
            margin-top: 20px;
        }
        
        .tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            overflow-x: auto;
        }
        
        .tab-button {
            padding: 12px 24px;
            border: none;
            background: #f0f0f0;
            color: #2B6735;
            cursor: pointer;
            border-radius: 8px 8px 0 0;
            font-weight: bold;
            transition: all 0.3s ease;
            white-space: nowrap;
        }
        
        .tab-button.active {
            background: #2B6735;
            color: white;
            border-bottom: 3px solid #B27F35;
        }
        
        .tab-button:hover:not(.active) {
            background: #e0e0e0;
        }
        
        .tab-content {
            display: none;
            padding: 20px;
            background: white;
            border: 1px solid #B27F35;
            border-radius: 0 8px 8px 8px;
            min-height: 300px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .analysis-table table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .analysis-table td {
            padding: 12px;
            border-bottom: 1px solid #eee;
        }
        
        .factor-label {
            font-weight: bold;
            color: #2B6735;
            width: 40%;
        }
        
        .h2h-overview {
            display: flex;
            justify-content: space-around;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, rgba(43, 103, 53, 0.1), rgba(178, 127, 53, 0.1));
            border-radius: 10px;
        }
        
        #head-to-head h4 {
            color: #2B6735;
            border-bottom: 2px solid #B27F35;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        
        .h2h-stat {
            text-align: center;
        }
        
        .h2h-number {
            display: block;
            font-size: 36px;
            font-weight: bold;
            color: #2B6735;
        }
        
        .h2h-label {
            display: block;
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }
        
        .team1-stat .h2h-number {
            color: #2B6735;
        }
        
        .team2-stat .h2h-number {
            color: #B27F35;
        }
        
        .recent-matches {
            margin-top: 20px;
        }
        
        .match-result {
            padding: 10px;
            margin: 10px 0;
            background: #f9f9f9;
            border-left: 4px solid #B27F35;
            border-radius: 4px;
        }
        
        .venue-stats table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .venue-stats td {
            padding: 12px;
            border-bottom: 1px solid #eee;
        }
        
        .form-tables {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .team-form {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 8px;
        }
        
        .team-form h4 {
            margin-top: 0;
            color: #2B6735;
            border-bottom: 2px solid #B27F35;
            padding-bottom: 10px;
        }
        
        .form-match {
            padding: 8px;
            margin: 8px 0;
            background: white;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .form-match.win {
            border-left: 4px solid #2B6735;
        }
        
        .form-match.loss {
            border-left: 4px solid #d32f2f;
        }
        
        .form-match .result {
            font-weight: bold;
        }
        
        .form-match .result.win {
            color: #2B6735;
        }
        
        .form-match .result.loss {
            color: #d32f2f;
        }
        
        /* Points Table Styles */
        .points-table-container {
            overflow-x: auto;
            margin-bottom: 15px;
        }
        
        .points-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
        }
        
        .points-table th, 
        .points-table td {
            padding: 10px;
            text-align: center;
            border-bottom: 1px solid #eee;
        }
        
        .points-table th {
            background-color: #2B6735;
            color: white;
            font-weight: bold;
        }
        
        .points-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        .points-table tr:hover {
            background-color: #f0f0f0;
        }
        
        .points-table tr.playoff-position {
            background-color: rgba(43, 103, 53, 0.1);
        }
        
        .points-table td:first-child {
            text-align: left;
            font-weight: bold;
            color: #2B6735;
        }
        
        .points-table td.nrr-positive {
            color: #2B6735;
        }
        
        .points-table td.nrr-negative {
            color: #d32f2f;
        }
        
        .points-table-team-logo {
            width: 20px;
            height: 20px;
            margin-right: 10px;
            vertical-align: middle;
        }
        
        .points-table-legend {
            font-size: 12px;
            color: #666;
            margin-top: 10px;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 5px;
            border: 1px solid #eee;
        }
        
        .points-table-legend p {
            margin: 5px 0;
        }
        
        .table-form-indicator {
            display: inline-block;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            color: white;
            text-align: center;
            line-height: 16px;
            font-weight: bold;
            font-size: 10px;
            margin: 0 1px;
        }
        
        .table-form-indicator.win {
            background-color: #2B6735;
        }
        
        .table-form-indicator.loss {
            background-color: #d32f2f;
        }
        
        .table-form-indicator.no-result {
            background-color: #666;
        }
        
        @media (max-width: 768px) {
            .form-tables {
                grid-template-columns: 1fr;
            }
            
            .tabs {
                flex-wrap: wrap;
            }
            
            .tab-button {
                flex: 1;
                min-width: 120px;
            }
            
            .points-table th, 
            .points-table td {
                padding: 8px 5px;
                font-size: 12px;
            }
        }
        
        /* Form indicators for recent team performance */
        #recent-form {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .form-indicator {
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            color: white;
            text-align: center;
            line-height: 20px;
            font-weight: bold;
            font-size: 12px;
            margin: 0 2px;
        }
        
        .form-indicator.win {
            background-color: #2B6735;
        }
        
        .form-indicator.loss {
            background-color: #d32f2f;
        }
        
        .form-indicator.no-result {
            background-color: #666;
        }
</style>
</head>
<body>
    <div class="container">
        <div class="inner-content">
          <header>
            <div class="cricket-icons"></div>
            <div class="header-content">
              <div class="logo">
                <img src="logo/yoda_yorker.png" alt="Yorker_yodas" style="width: 100px; height: 100px; border-radius: 50%;" />
              </div>
              <div>
                <h1>Winning Yoda</h1>
                <p class="tagline">PSL Match Predictor <span style="font-size: 10px; color: #eee;"></span></p>
              </div>
            </div>
          </header>
          
          <!-- News Ticker -->
          <div class="news-ticker">
            <div class="ticker-wrap">
              <div class="ticker-content">
                BREAKING: üìä POINTS TABLE UPDATED WITH LATEST DATA AS OF MAY 8, 2025 ‚Ä¢ 
                Quetta Gladiators (13 pts) lead the table after win against Multan Sultans ‚Ä¢ 
                Karachi Kings and Islamabad United tied on 10 points ‚Ä¢ 
                Lahore Qalandars (9 pts) and Peshawar Zalmi (8 pts) still in playoff contention ‚Ä¢ 
                Quetta Gladiators beat Multan Sultans by 10 wickets to secure top spot ‚Ä¢ 
                Peshawar Zalmi keep playoff hopes alive after crushing Sultans by 7 wickets ‚Ä¢ 
                Quetta Gladiators beat Islamabad United by 2 wickets in a thrilling last-over finish ‚Ä¢ 
                Karachi Kings beat Lahore Qalandars by 4 wickets, Irfan the hero as Kings ace the chase ‚Ä¢ 
                PSL confirms final to be held at Gaddafi Stadium on May 18 as scheduled ‚Ä¢
                Zalmi vs Kings tonight in crucial match with playoff implications
              </div>
            </div>
          </div>
        </div>
      </div>

        <div class="match-selector">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <h3 style="color: #2B6735; margin: 0;">Upcoming Matches</h3>
            </div>
            <div id="quick-match-buttons" class="match-buttons">
                <!-- Upcoming match buttons will be populated here -->
            </div>
        </div>
        
        <div class="upcoming-matches" style="display: none;">
            <div id="upcoming-matches-list" class="match-list">
                <!-- Upcoming matches will be displayed here -->
            </div>
        </div>

        <div id="match-details" style="display: none;">
            <h3 id="match-title">Match Details</h3>
            <div class="team-logos">
                <div>
                    <div id="team1-logo" class="team-logo"></div>
                    <p id="team1-name" style="text-align: center; font-weight: bold;"></p>
                </div>
                <div style="font-weight: bold; font-size: 24px;">VS</div>
                <div>
                    <div id="team2-logo" class="team-logo"></div>
                    <p id="team2-name" style="text-align: center; font-weight: bold;"></p>
                </div>
            </div>
            <div style="margin-top: 20px;">
                <p><strong>Date:</strong> <span id="match-date"></span></p>
                <p><strong>Time:</strong> <span id="match-time"></span></p>
                <p><strong>Venue:</strong> <span id="match-venue"></span></p>
                <p><strong>Head to Head:</strong> <span id="head-to-head"></span></p>
            </div>
        </div>

        <div id="analysis-breakdown" style="display: none;">
            <h3 style="margin-top: 30px; color: #2B6735; border-bottom: 2px solid #B27F35; padding-bottom: 10px;">üìä Analysis Breakdown</h3>
            
            <div class="tabs-container">
                <div class="tabs">
                    <button class="tab-button active" data-tab="key-factors">Key Factors</button>
                    <button class="tab-button" data-tab="venue-analysis">Venue Analysis</button>
                    <button class="tab-button" data-tab="current-form">Current Form</button>
                    <button class="tab-button" data-tab="points-table">Points Table</button>
                </div>
                
                <div class="tab-content active" id="key-factors">
                    <div class="analysis-table">
                        <h4>Prediction Factors</h4>
                        <table>
                            <tr>
                                <td class="factor-label">Head-to-Head in PSL 2025</td>
                                <td id="h2h-current-season"></td>
                            </tr>
                            <tr>
                                <td class="factor-label">Toss Advantage at Venue</td>
                                <td id="toss-advantage"></td>
                            </tr>
                            <tr>
                                <td class="factor-label">PSL 2025 Win Percentage</td>
                                <td id="win-percentage"></td>
                            </tr>
                           <tr>
                                <td class="factor-label">Performance at Venue</td>
                                <td id="venue-performance"></td>
                            </tr>
                            <tr>
                                <td class="factor-label">Recent Form (Last 5 matches)</td>
                                <td id="recent-form"><span style="color: #B27F35;"></span></td>
                            </tr>
                            <tr>
                                <td class="factor-label">Key Players Availability</td>
                                <td id="key-players-status"></td>
                            </tr>
                        </table>
                    </div>
                </div>
                
                <div class="tab-content" id="venue-analysis">
                    <div class="venue-stats">
                        <h4 id="venue-name">Venue Stats</h4>
                        <table>
                            <tr>
                                <td class="factor-label">Average 1st Innings Score</td>
                                <td id="avg-first-innings"></td>
                            </tr>
                            <tr>
                                <td class="factor-label">Average 2nd Innings Score</td>
                                <td id="avg-second-innings"></td>
                            </tr>
                            <tr>
                                <td class="factor-label">Toss Decision Trend</td>
                                <td id="toss-decision-trend"></td>
                            </tr>
                        </table>
                    </div>
                </div>
                
                <div class="tab-content" id="current-form">
                    <div class="form-tables">
                        <div class="team-form">
                            <h4 id="team1-form-title">Team 1 - Recent Form</h4>
                            <div id="team1-recent-form"></div>
                        </div>
                        <div class="team-form">
                            <h4 id="team2-form-title">Team 2 - Recent Form</h4>
                            <div id="team2-recent-form"></div>
                        </div>
                    </div>
                </div>
                
                <div class="tab-content" id="points-table">
                    <h4>PSL 2025 Points Table</h4>
                    <div class="points-table-container">
                        <table class="points-table">
                            <thead>
                                <tr>
                                    <th>Team</th>
                                    <th>M</th>
                                    <th>W</th>
                                    <th>L</th>
                                    <th>NR</th>
                                    <th>Pts</th>
                                    <th>NRR</th>
                                    <th>Form</th>
                                </tr>
                            </thead>
                            <tbody id="points-table-body">
                                <!-- Table data will be populated here -->
                            </tbody>
                        </table>
                    </div>
                    <div class="points-table-legend">
                        <p>M: Matches | W: Wins | L: Losses | NR: No Result | Pts: Points | NRR: Net Run Rate</p>
                        <p>Top 4 teams qualify for playoffs</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="weather-selector" style="display: none;">
            <label for="weather">Select Weather Condition:</label><br>
            <select id="weather">
                <option value="Clear">Clear</option>
                <option value="Cloudy">Cloudy</option>
                <option value="Light Rain">Light Rain</option>
                <option value="Hot and Humid">Hot and Humid</option>
            </select>
            <br>
            <button id="predict-btn" class="predict-btn"><span>Predict</span></button>
        </div>

        <div id="loading" class="loading-spinner"></div>

        <div id="prediction-result" class="prediction-result">
            <div id="prediction-text"></div>
            <div id="yoda-quote" class="quote"></div>
            <div class="stats-grid">
                <div class="stat-card">
                    <h4>Win Probability</h4>
                    <div id="win-probability"></div>
                </div>
                <div class="stat-card">
                    <h4>Key Player</h4>
                    <div id="key-player"></div>
                </div>
                <div class="stat-card">
                    <h4>Expected Score</h4>
                    <div id="expected-score"></div>
                </div>
                <div class="stat-card">
                    <h4>Toss Impact</h4>
                    <div id="toss-impact"></div>
                </div>
            </div>
        </div>
        <!-- Upcoming Matches Section has been moved to the top -->
        
        <!-- Social Media Highlights -->
        <div class="social-highlights">
            <div class="social-title">Social Media Highlights</div>
            <div class="social-posts">
                <div class="social-post">
                    <div class="post-header">
                        <div class="post-avatar">
                            <img src="logo/psl.png" alt="PSL Official Avatar" />
                        </div>
                        <div class="post-info">
                            <div class="post-author">PSL Official</div>
                            <div class="post-date">2 days ago</div>
                        </div>
                    </div>
                    <div class="post-content">
                        As we approach the business end of #PSLX, the points table is getting tighter! Which four teams do you think will make it to the playoffs? #PSL2025 #CricketFever
                    </div>
                    <div class="post-actions">
                        <div class="post-action"><i>‚ù§Ô∏è</i> 5.2K</div>
                        <div class="post-action"><i>üí¨</i> 853</div>
                        <div class="post-action"><i>üîÑ</i> 1.7K</div>
                    </div>
                </div>
                
                <div class="social-post">
                    <div class="post-header">
                        <div class="post-avatar">
                            <img src="logo/peshawar_zalmi.png" alt="peshawar_zalmi Avatar" />
                        </div>
                        <div class="post-info">
                            <div class="post-author">Peshawar_Zalmi</div>
                            <div class="post-date">5 hours ago</div>
                        </div>
                    </div>
                    <div class="post-content">
                        Finish in style ‚Äî the Zalmi way ‚ö° Big hits, big moments, big energyüôåüíõ #Zalmi #ZalmiXLegacy #YellowStorm¬†#HBLPSLX¬†#MSvPZ
                    </div>
                    <div class="post-actions">
                        <div class="post-action"><i>‚ù§Ô∏è</i> 3.8K</div>
                        <div class="post-action"><i>üí¨</i> 492</div>
                        <div class="post-action"><i>üîÑ</i> 921</div>
                    </div>
                </div>
                
                <div class="social-post">
                    <div class="post-header">
                        <div class="post-avatar">
                            <img src="logo/analyst.jpeg" alt="Cricket Analyst Avatar" />
                        </div>
                        <div class="post-info">
                            <div class="post-author">Cricket Analyst</div>
                            <div class="post-date">Yesterday</div>
                        </div>
                    </div>
                    <div class="post-content">
                        Mohammad Rizwan continues to be the standout batsman in #PSLX with 363 runs in 9 innings at an average of 60.50. Phenomenal consistency from the Multan Sultans captain despite his team's struggles. #PSL2025 #CricketStats
                    </div>
                    <div class="post-actions">
                        <div class="post-action"><i>‚ù§Ô∏è</i> 2.4K</div>
                        <div class="post-action"><i>üí¨</i> 315</div>
                        <div class="post-action"><i>üîÑ</i> 687</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Team data with details
        const teamData = {
            "Islamabad United": { code: "IU", color: "#A81D33" },
            "Peshawar Zalmi": { code: "PZ", color: "#FFC700" },
            "Quetta Gladiators": { code: "QG", color: "#4B0082" },
            "Lahore Qalandars": { code: "LQ", color: "#00A651" },
            "Karachi Kings": { code: "KK", color: "#1C3C7C" },
            "Multan Sultans": { code: "MS", color: "#00B5AF" }
        };

        // All PSL 2025 matches - Updated with remaining games
        const allMatches = {
            "Match24": {
                team1: "Lahore Qalandars",
                team2: "Karachi Kings",
                date: "2025-05-04",
                time: "7:00 PM",
                venue: "Lahore"
            },
            "Match25": {
                team1: "Multan Sultans",
                team2: "Peshawar Zalmi",
                date: "2025-05-05",
                time: "7:00 PM",
                venue: "Multan"
            },
            "Match26": {
                team1: "Islamabad United",
                team2: "Quetta Gladiators",
                date: "2025-05-07",
                time: "7:00 PM",
                venue: "Rawalpindi"
            },
            "Match27": {
                team1: "Karachi Kings",
                team2: "Peshawar Zalmi",
                date: "2025-05-08",
                time: "7:00 PM",
                venue: "Rawalpindi"
            },
            "Match28": {
                team1: "Lahore Qalandars",
                team2: "Peshawar Zalmi",
                date: "2025-05-09",
                time: "7:00 PM",
                venue: "Rawalpindi"
            },
            "Match29": {
                team1: "Islamabad United",
                team2: "Karachi Kings",
                date: "2025-05-10",
                time: "7:00 PM",
                venue: "Rawalpindi"
            },
            "Match30": {
                team1: "Multan Sultans",
                team2: "Quetta Gladiators",
                date: "2025-05-11",
                time: "7:00 PM",
                venue: "Multan"
            },
            // Playoff matches
            "Qualifier 1": {
                team1: "TBA",
                team2: "TBA",
                date: "2025-05-13",
                time: "7:00 PM",
                venue: "Rawalpindi"
            },
            "Eliminator": {
                team1: "TBA",
                team2: "TBA",
                date: "2025-05-14",
                time: "7:00 PM",
                venue: "Lahore"
            },
            "Qualifier 2": {
                team1: "TBA",
                team2: "TBA",
                date: "2025-05-16",
                time: "7:00 PM",
                venue: "Lahore"
            },
            "Final": {
                team1: "TBA",
                team2: "TBA",
                date: "2025-05-18",
                time: "7:00 PM",
                venue: "Lahore"
            }
        };

        // Get today's date at start of day
        function getTodayStart() {
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            return today;
        }
        
        // Function to properly compare match dates with today
        function isDateInFuture(matchDateStr) {
            if (!matchDateStr) return false;
            
            try {
                const matchDate = new Date(matchDateStr);
                const today = getTodayStart();
                
                // Debug date comparison if in debug mode
                if (window.debugLogger && window.debugLogger.isEnabled && window.debugLogger.isEnabled()) {
                    console.log(`Date comparison: Match date ${matchDate.toISOString()} vs Today ${today.toISOString()}`);
                }
                
                return matchDate >= today;
            } catch (error) {
                console.error("Error comparing dates:", error);
                return false;
            }
        }

        // Function to get upcoming matches
        function getUpcomingMatches() {
            const upcomingMatches = {};
            
            // Check if allMatches exists
            if (!allMatches || typeof allMatches !== 'object') {
                console.error("allMatches not properly initialized");
                return upcomingMatches;
            }
            
            try {
                for (const [key, match] of Object.entries(allMatches)) {
                    // Use our improved date comparison function
                    if (isDateInFuture(match.date)) {
                        upcomingMatches[key] = match;
                    }
                }
                
                if (Object.keys(upcomingMatches).length === 0) {
                    console.warn("No upcoming matches found. Using all matches as fallback.");
                    // If no upcoming matches found, return all matches as fallback
                    return allMatches;
                }
                
                return upcomingMatches;
            } catch (error) {
                console.error("Error getting upcoming matches:", error);
                return allMatches; // Return all matches as fallback
            }
        }

        // Function to populate match buttons
        function populateMatchSelector() {
            const matchButtonsContainer = document.getElementById('quick-match-buttons');
            matchButtonsContainer.innerHTML = '';
            
            const upcomingMatches = getUpcomingMatches();
            let count = 0;
            
            for (const [key, match] of Object.entries(upcomingMatches)) {
                if (count >= 6) break; // Show only 6 upcoming matches
                
                const matchDate = new Date(match.date);
                const today = new Date();
                const tomorrow = new Date(today);
                tomorrow.setDate(tomorrow.getDate() + 1);
                
                // Format date string
                const dateStr = matchDate.toLocaleDateString('en-US', { 
                    month: 'long', 
                    day: 'numeric'
                });
                
                // Add today/tomorrow label
                let timeLabel = '';
                if (matchDate.toDateString() === today.toDateString()) {
                    timeLabel = ' (Today)';
                } else if (matchDate.toDateString() === tomorrow.toDateString()) {
                    timeLabel = ' (Tomorrow)';
                }
                
                const button = document.createElement('button');
                button.className = 'match-button';
                button.dataset.matchId = key;
                
                // Create team icons
                // Create team icons (with proper error handling)
                let team1Icon = '';
                let team2Icon = '';
                
                try {
                    if (!match.team1.includes('TBA')) {
                        team1Icon = `<img src="logo/${match.team1.toLowerCase().replace(' ', '_')}.png" alt="${match.team1}" class="team-icon">`;
                    }
                    
                    if (!match.team2.includes('TBA')) {
                        team2Icon = `<img src="logo/${match.team2.toLowerCase().replace(' ', '_')}.png" alt="${match.team2}" class="team-icon">`;
                    }
                } catch (error) {
                    console.error("Error creating team icons:", error);
                }
                
                button.innerHTML = `
                    <div>
                        <div class="match-button-teams">${team1Icon} ${match.team1} vs ${team2Icon} ${match.team2}</div>
                        <div class="match-button-details">${dateStr}${timeLabel} ‚Ä¢ ${match.time} ‚Ä¢ ${match.venue}</div>
                    </div>
                `;
                
                button.addEventListener('click', function() {
                    // Remove 'selected' class from all buttons
                    document.querySelectorAll('.match-button').forEach(btn => {
                        btn.classList.remove('selected');
                    });
                    
                    // Add 'selected' class to clicked button
                    this.classList.add('selected');
                    
                    // Show match details
                    showMatchDetails(this.dataset.matchId);
                });
                
                matchButtonsContainer.appendChild(button);
                count++;
            }
        }
        
        // Function to populate upcoming matches section
        function populateUpcomingMatches() {
            const upcomingMatchesList = document.getElementById('upcoming-matches-list');
            const upcomingMatches = getUpcomingMatches();
            
            let html = '';
            let count = 0;
            
            for (const [key, match] of Object.entries(upcomingMatches)) {
                if (count >= 6) break; // Show only 6 upcoming matches
                
                const matchDate = new Date(match.date);
                const dateStr = matchDate.toLocaleDateString('en-US', { 
                    weekday: 'short',
                    month: 'short', 
                    day: 'numeric',
                    year: '2-digit'
                });

                // Check if teams are TBA
                const team1Logo = match.team1.includes('TBA') ? 
                    '<img src="/api/placeholder/40/40" alt="TBA" />' : 
                    `<img src="logo/${match.team1.toLowerCase().replace(' ', '_')}.png" alt="${match.team1} Logo" />`;
                
                const team2Logo = match.team2.includes('TBA') ?
                    '<img src="/api/placeholder/40/40" alt="TBA" />' :
                    `<img src="logo/${match.team2.toLowerCase().replace(' ', '_')}.png" alt="${match.team2} Logo" />`;
                
                // Format match number/title
                const matchTitle = key.includes('Match') ? `${key.replace('Match', 'Match ')}`  : key;
                
                html += `
                    <div class="match-item">
                        <div class="match-item-header">${dateStr} ‚Ä¢ ${match.time} ‚Ä¢ ${match.venue}</div>
                        <div class="match-item-teams">
                            <div class="match-item-team">
                                <div class="match-item-logo">
                                    ${team1Logo}
                                </div>
                                <div class="match-item-name">${match.team1}</div>
                            </div>
                            <div class="match-item-vs">VS</div>
                            <div class="match-item-team">
                                <div class="match-item-logo">
                                    ${team2Logo}
                                </div>
                                <div class="match-item-name">${match.team2}</div>
                            </div>
                        </div>
                        <div class="match-item-footer">${matchTitle}</div>
                    </div>
                `;
                count++;
            }
            
            upcomingMatchesList.innerHTML = html;
        }

        // Function to show match details
        function showMatchDetails(matchId) {
            const matchDetails = document.getElementById('match-details');
            const analysisBreakdown = document.getElementById('analysis-breakdown');
            const weatherSelector = document.getElementById('weather-selector');
            const predictionResult = document.getElementById('prediction-result');

            if (!matchId) {
                matchDetails.style.display = 'none';
                analysisBreakdown.style.display = 'none';
                weatherSelector.style.display = 'none';
                predictionResult.style.display = 'none';
                return;
            }

            const match = allMatches[matchId];
            if (!match) return;

            // Update match details
            document.getElementById('match-title').textContent = `${match.team1} vs ${match.team2}`;
            
            const team1Logo = document.getElementById('team1-logo');
            const team2Logo = document.getElementById('team2-logo');
            
            // Handle TBA teams or regular teams
            if (match.team1.includes('TBA')) {
                team1Logo.innerHTML = `<img src="/api/placeholder/100/100" alt="TBA">`;
            } else {
                team1Logo.innerHTML = `<img src="logo/${match.team1.toLowerCase().replace(' ', '_')}.png" alt="${match.team1}">`;
            }
            
            if (match.team2.includes('TBA')) {
                team2Logo.innerHTML = `<img src="/api/placeholder/100/100" alt="TBA">`;
            } else {
                team2Logo.innerHTML = `<img src="logo/${match.team2.toLowerCase().replace(' ', '_')}.png" alt="${match.team2}">`;
            }
            
            team1Logo.className = 'team-logo';
            team2Logo.className = 'team-logo';
            
            document.getElementById('team1-name').textContent = match.team1;
            document.getElementById('team2-name').textContent = match.team2;
            document.getElementById('match-date').textContent = new Date(match.date).toLocaleDateString('en-US', { 
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            document.getElementById('match-time').textContent = match.time;
            document.getElementById('match-venue').textContent = match.venue;
            // document.getElementById('head-to-head').textContent = match.headToHead;
            
            // Get overall head-to-head data (all-time)
            const overallH2hKey = [match.team1, match.team2].sort().join('-');
            const overallH2hData = overallHeadToHead[overallH2hKey];
            
            // Update head-to-head display with overall statistics
            let h2hText = '';
            if (overallH2hData) {
                const team1Index = overallH2hKey.indexOf(match.team1) === 0 ? 0 : 1;
                const team1Wins = team1Index === 0 ? overallH2hData.team1Wins : overallH2hData.team2Wins;
                const team2Wins = team1Index === 0 ? overallH2hData.team2Wins : overallH2hData.team1Wins;
                
                h2hText = `Overall Head-to-Head: ${overallH2hData.matches} matches | ${match.team1} ${team1Wins} wins, ${match.team2} ${team2Wins} wins`;
                
                if (overallH2hData.noResult > 0) {
                    h2hText += `, ${overallH2hData.noResult} no result`;
                }
            } else {
                h2hText = 'No head-to-head data available';
            }
            
            document.getElementById('head-to-head').textContent = h2hText;

            // Show sections
            matchDetails.style.display = 'block';
            analysisBreakdown.style.display = 'block';
            weatherSelector.style.display = 'block';
            predictionResult.style.display = 'none';
            
            // Update analysis breakdown
            updateAnalysisBreakdown(match);
        }

        function generatePrediction(matchId) {
            const weather = document.getElementById('weather').value;
            
            if (!matchId) {
                alert('Please select a match first!');
                return;
            }

            document.getElementById('loading').style.display = 'block';
            document.getElementById('prediction-result').style.display = 'none';

            setTimeout(() => {
                const match = allMatches[matchId];
                const team1 = match.team1;
                const team2 = match.team2;
                const venue = match.venue;

                // Initialize scores
                let team1Score = 0;
                let team2Score = 0;

                // 1. Head-to-Head Performance (25% weight)
                const h2hScore = calculateHeadToHeadScore(team1, team2);
                team1Score += h2hScore.team1 * 0.25;
                team2Score += h2hScore.team2 * 0.25;

                // 2. Venue-Specific Analysis (20% weight)
                const venueScore = calculateVenueScore(team1, team2, venue);
                team1Score += venueScore.team1 * 0.20;
                team2Score += venueScore.team2 * 0.20;

                // 3. Current Tournament Form (35% weight)
                const formScore = calculateCurrentFormScore(team1, team2);
                team1Score += formScore.team1 * 0.35;
                team2Score += formScore.team2 * 0.35;

                // 4. Team Composition and Conditions (20% weight)
                const conditionsScore = calculateConditionsScore(team1, team2, weather, venue);
                team1Score += conditionsScore.team1 * 0.20;
                team2Score += conditionsScore.team2 * 0.20;

                // Normalize scores to percentages
                const totalScore = team1Score + team2Score;
                let team1Prob = Math.round((team1Score / totalScore) * 100);
                let team2Prob = Math.round((team2Score / totalScore) * 100);

                // Ensure total is 100%
                if (team1Prob + team2Prob !== 100) {
                    team2Prob = 100 - team1Prob;
                }

                const winner = team1Prob > team2Prob ? team1 : team2;
                const keyPlayers = {
                    "Islamabad United": ["Shadab Khan(c)", "Naseem Shah", "Colin Munro", "Imad Wasim"],
                    "Lahore Qalandars": ["Shaheen Afridi(c)", "Fakhar Zaman", "Haris Rauf", "Sam Billings"],
                    "Karachi Kings": ["David Warner(c)", "Hasan Ali", "James Vince", "Khusdil Shah"],
                    "Quetta Gladiators": ["Saud Shakeel(c)", "Finn Allen", "Abrar ahmed", "Mohammad Amir",],
                    "Peshawar Zalmi": ["Babar Azam(c)", "Abdul Samad", "Saim Ayub", "Ali Raza"],
                    "Multan Sultans": ["Mohammad Rizwan(c)", "Usman Khan", "Josh Little", "Usama Mir"]
                };

                const keyPlayer = keyPlayers[winner][Math.floor(Math.random() * 3)];
                const isClose = Math.abs(team1Prob - team2Prob) < 10;

                // Update prediction text
                document.getElementById('prediction-text').innerHTML = `
                    <strong>${winner} are favored to win${isClose ? ' in a close contest' : ''}</strong><br><br>
                    Our analysis shows a competitive match ahead${isClose ? ', with both teams evenly matched' : 
                    ', with one team having a clear advantage'}.
                `;

                // Update win probabilities
                document.getElementById('win-probability').innerHTML = `
                    ${team1}: ${team1Prob}%<br>
                    ${team2}: ${team2Prob}%
                `;

                // Update key player
                document.getElementById('key-player').textContent = keyPlayer;

                // Update expected score based on conditions and venue
                const venueData = pslData.venues[venue] || pslData.venues["Lahore"];
                const avgScore = (venueData.avgFirstInnings + venueData.avgSecondInnings) / 2;
                const weatherAdjustment = {
                    'Clear': 0,
                    'Cloudy': -7,
                    'Light Rain': -11,
                    'Hot and Humid': -3
                }[weather];
                
                const expectedAvg = avgScore + weatherAdjustment;
                const minScore = Math.round(expectedAvg - 10);
                const maxScore = Math.round(expectedAvg + 10);
                document.getElementById('expected-score').textContent = `${minScore}-${maxScore}`;

                // Update toss impact based on venue data
                document.getElementById('toss-impact').textContent = 
                    venueData.tossDecision.includes("field") ? "Teams prefer chasing at this venue" : 
                    "Teams prefer batting first at this venue";

                // Show Yoda quote
                const yodaQuotes = [
                    "Size matters not. The Force in cricket, strong it is.",
                    "Do or do not. There is no try in this match.",
                    "Difficult to see. Always in motion is the future of cricket.",
                    "Trust in the Force, and good cricket will follow.",
                    "Victory? Victory you say? Master cricket you must, to achieve it."
                ];
                document.getElementById('yoda-quote').textContent = 
                    yodaQuotes[Math.floor(Math.random() * yodaQuotes.length)];

                document.getElementById('loading').style.display = 'none';
                document.getElementById('prediction-result').style.display = 'block';
            }, 2000);
        }

        // Calculate head-to-head score
        function calculateHeadToHeadScore(team1, team2) {
            const overallH2hKey = [team1, team2].sort().join('-');
            const overallH2hData = overallHeadToHead[overallH2hKey];
            
            // PSL 2025 head-to-head
            const h2hKey = [team1, team2].sort().join('-');
            const h2hData = pslData.headToHead[h2hKey] || { total: 0, matches: [] };
            
            let team1Score = 50; // Base score
            let team2Score = 50; // Base score
            
            // Overall historical head-to-head (60% of h2h score)
            if (overallH2hData) {
                const team1Index = overallH2hKey.indexOf(team1) === 0 ? 0 : 1;
                const team1Wins = team1Index === 0 ? overallH2hData.team1Wins : overallH2hData.team2Wins;
                const team2Wins = team1Index === 0 ? overallH2hData.team2Wins : overallH2hData.team1Wins;
                
                if (overallH2hData.matches > 0) {
                    team1Score = (team1Wins / overallH2hData.matches) * 60;
                    team2Score = (team2Wins / overallH2hData.matches) * 60;
                }
            }
            
            // PSL 2025 head-to-head (40% of h2h score)
            if (h2hData.total > 0) {
                let team1PSLWins = 0;
                let team2PSLWins = 0;
                
                h2hData.matches.forEach(match => {
                    if (match.result.includes(team1) && match.result.includes("won")) {
                        team1PSLWins++;
                    } else if (match.result.includes(team2) && match.result.includes("won")) {
                        team2PSLWins++;
                    }
                });
                
                team1Score += (team1PSLWins / h2hData.total) * 40;
                team2Score += (team2PSLWins / h2hData.total) * 40;
            }
            
            return { team1: team1Score, team2: team2Score };
        }

        // Calculate venue-specific score
        function calculateVenueScore(team1, team2, venue) {
            const venueData = pslData.venues[venue] || pslData.venues["Lahore"];
            let team1Score = 50;
            let team2Score = 50;
            
            // Toss advantage (50% of venue score)
            const tossAdvantage = parseInt(venueData.winningToss) || 50;
            team1Score = tossAdvantage;
            team2Score = tossAdvantage;
            
            // Teams' previous performances at venue (50% of venue score)
            // This would require more specific venue data, so using a simplified approach
            const team1Data = pslData.teams[team1];
            const team2Data = pslData.teams[team2];
            
            team1Score += (team1Data.wins / team1Data.matches) * 50;
            team2Score += (team2Data.wins / team2Data.matches) * 50;
            
            return { team1: team1Score, team2: team2Score };
        }

        // Calculate current form score
        function calculateCurrentFormScore(team1, team2) {
            const team1Data = pslData.teams[team1];
            const team2Data = pslData.teams[team2];
            
            let team1Score = 0;
            let team2Score = 0;
            
            // Win percentage in PSL 2025 (40% of form score)
            team1Score += (team1Data.wins / team1Data.matches) * 40;
            team2Score += (team2Data.wins / team2Data.matches) * 40;
            
            // Recent form - last 5 matches (40% of form score)
            const team1RecentForm = team1Data.form.slice(-5);
            const team2RecentForm = team2Data.form.slice(-5);
            
            const team1RecentWins = (team1RecentForm.match(/W/g) || []).length;
            const team2RecentWins = (team2RecentForm.match(/W/g) || []).length;
            
            team1Score += (team1RecentWins / 5) * 40;
            team2Score += (team2RecentWins / 5) * 40;
            
            // Net run rate (20% of form score)
            const team1NRR = parseFloat(team1Data.nrr) || 0;
            const team2NRR = parseFloat(team2Data.nrr) || 0;
            
            // Normalize NRR to a 0-100 scale
            const maxNRR = Math.max(Math.abs(team1NRR), Math.abs(team2NRR), 1);
            team1Score += ((team1NRR + maxNRR) / (2 * maxNRR)) * 20;
            team2Score += ((team2NRR + maxNRR) / (2 * maxNRR)) * 20;
            
            return { team1: team1Score, team2: team2Score };
        }

        // Calculate conditions score
        function calculateConditionsScore(team1, team2, weather, venue) {
            let team1Score = 50;
            let team2Score = 50;
            
            // Key player availability (40% of conditions score)
            // Assuming all players are available for now
            team1Score += 20;
            team2Score += 20;
            
            // Team balance (30% of conditions score)
            // Using win percentage as a proxy for team balance
            const team1Data = pslData.teams[team1];
            const team2Data = pslData.teams[team2];
            
            team1Score += (team1Data.wins / team1Data.matches) * 15;
            team2Score += (team2Data.wins / team2Data.matches) * 15;
            
            // Weather conditions (30% of conditions score)
            const weatherAdvantage = {
                'Clear': { fast: 0, spin: 0 },
                'Cloudy': { fast: 10, spin: -5 },
                'Light Rain': { fast: 15, spin: -10 },
                'Hot and Humid': { fast: -5, spin: 10 }
            }[weather];
            
            // Assign advantage based on team strengths (simplified)
            const teamStrengths = {
                "Islamabad United": "balanced",
                "Lahore Qalandars": "fast",
                "Karachi Kings": "balanced",
                "Quetta Gladiators": "spin",
                "Peshawar Zalmi": "fast",
                "Multan Sultans": "spin"
            };
            
            if (teamStrengths[team1] === "fast") team1Score += weatherAdvantage.fast;
            if (teamStrengths[team1] === "spin") team1Score += weatherAdvantage.spin;
            if (teamStrengths[team2] === "fast") team2Score += weatherAdvantage.fast;
            if (teamStrengths[team2] === "spin") team2Score += weatherAdvantage.spin;
            
            return { team1: team1Score, team2: team2Score };
        }

        // Function to update additional match-specific data
        function updateAdditionalMatchData(team1, team2, venue) {
            // Additional updates for the specific match can be added here
            // This function can be expanded to include more match-specific data
            console.log(`Additional data updated for ${team1} vs ${team2} at ${venue}`);
        }

        // Tab switching functionality
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('tab-button')) {
                // Remove active class from all tabs and contents
                document.querySelectorAll('.tab-button').forEach(tab => tab.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                
                // Add active class to clicked tab and corresponding content
                e.target.classList.add('active');
                const tabId = e.target.getAttribute('data-tab');
                document.getElementById(tabId).classList.add('active');
            }
        });

        // Overall PSL head-to-head data (all-time)
        const overallHeadToHead = {
            "Islamabad United-Quetta Gladiators": {
                matches: 20,
                team1Wins: 10,
                team2Wins: 9,
                noResult: 1
            },
            "Karachi Kings-Lahore Qalandars": {
                matches: 19,
                team1Wins: 13,
                team2Wins: 6,
                noResult: 0
            },
            "Multan Sultans-Peshawar Zalmi": {
                matches: 16,
                team1Wins: 11,
                team2Wins: 5,
                noResult: 0
            },
            "Karachi Kings-Peshawar Zalmi": {
                matches: 21,
                team1Wins: 6,
                team2Wins: 15,
                noResult: 0
            },
            "Lahore Qalandars-Peshawar Zalmi": {
                matches: 19,
                team1Wins: 8,
                team2Wins: 11,
                noResult: 0
            },
            "Islamabad United-Multan Sultans": {
                matches: 16,
                team1Wins: 8,
                team2Wins: 8,
                noResult: 0
            },
            "Karachi Kings-Quetta Gladiators": {
                matches: 18,
                team1Wins: 6,
                team2Wins: 12,
                noResult: 0
            },
            "Lahore Qalandars-Multan Sultans": {
                matches: 19,
                team1Wins: 9,
                team2Wins: 10,
                noResult: 0
            },
            "Islamabad United-Peshawar Zalmi": {
                matches: 24,
                team1Wins: 12,
                team2Wins: 12,
                noResult: 0
            },
            "Islamabad United-Karachi Kings": {
                matches: 23,
                team1Wins: 17,
                team2Wins: 6,
                noResult: 0
            },
            "Multan Sultans-Quetta Gladiators": {
                matches: 13,
                team1Wins: 9,
                team2Wins: 4,
                noResult: 0
            }
        };

        // PSL 2025 comprehensive match data
        const pslData = {
            teams: {
                "Islamabad United": {
                    matches: 9,
                    wins: 5,
                    losses: 4,
                    points: 10,
                    nrr: "-0.044",
                    form: "WWWWWLLLL",
                    recentMatches: [
                        { opponent: "Quetta Gladiators", result: "Lost by 109 Runs", date: "2025-05-07" },
                        { opponent: "Quetta Gladiators", result: "Lost by 2 wickets", date: "2025-05-03" },
                        { opponent: "Peshawar Zalmi", result: "Lost by 6 wickets", date: "2025-05-02" },
                        { opponent: "Lahore Qalandars", result: "Lost by 88 runs", date: "2025-04-30" },
                        { opponent: "Multan Sultans", result: "Won by 7 wickets", date: "2025-04-23" },
                        { opponent: "Karachi Kings", result: "Won by 6 wickets", date: "2025-04-20" },
                        { opponent: "Multan Sultans", result: "Won by by 47 runs", date: "2025-04-16" },
                        { opponent: "Peshawar Zalmi", result: "Won by 102 runs", date: "2025-04-14" },
                        { opponent: "Lahore Qalandars", result: "Won by 8 wickets", date: "2025-04-11" }
                    ]
                },
                "Lahore Qalandars": {
                    matches: 9,
                    wins: 4,
                    losses: 4,
                    points: 9,
                    nrr: "+0.958",
                    form: "LWWLLWWNRL",
                    recentMatches: [
                        { opponent: "Karachi Kings", result: "Lost by 4 wickets", date: "2025-05-01" },
                        { opponent: "Quetta Gladiators", result: "No result (Rain)", date: "2025-05-01" },
                        { opponent: "Islamabad United", result: "Won by 88 runs", date: "2025-04-30" },
                        { opponent: "Islamabad United", result: "Won by 5 wickets", date: "2025-04-26" },
                        { opponent: "Peshawar Zalmi", result: "Lost by 7 wickets", date: "2025-04-24" },
                        { opponent: "Multan Sultans", result: "Lost by 33 runs", date: "2025-04-22" },
                        { opponent: "Karachi KIngs", result: "Won by 65 runs", date: "2025-04-15" },
                        { opponent: "Quetta Gladiators", result: "Won by 79 Runs", date: "2025-04-13" },
                        { opponent: "Islamabad United", result: "Lost by 8 wickets", date: "2025-04-11" }
                    ]
                },
                "Karachi Kings": {
                    matches: 8,
                    wins: 5,
                    losses: 3,
                    points: 10,
                    nrr: "0.433",
                    form: "WLWLWLWW",
                    recentMatches: [
                        { opponent: "Lahore Qalandars", result: "Won by 4 Wickets", date: "2025-05-04" },
                        { opponent: "Multan Sultans", result: "Won by 87 runs", date: "2025-05-01" },
                        { opponent: "Quetta Gladiators", result: "Lost by 5 runs", date: "2025-04-25" },
                        { opponent: "Peshawar Zalmi", result: "Won by 2 wickets", date: "2025-04-21" },
                        { opponent: "Islamabad United", result: "Lost by 6 wickets", date: "2025-04-20" },
                        { opponent: "Quetta Gladiators", result: "Won by 56 runs", date: "2025-04-18" },
                        { opponent: "Lahore Qalandars", result: "Lost by 65 runs", date: "2025-04-15" },
                        { opponent: "Karachi Kings", result: "Won by 4 Wickets", date: "2025-04-12" }
                    ]
                },
                "Quetta Gladiators": {
                    matches: 9,
                    wins: 6,
                    losses: 2,
                    points: 13,
                    nrr: "+1.503",
                    form: "WLLWWWNWW",
                    recentMatches: [
                        { opponent: "Islamabad United", result: "Won by 109 runs", date: "2025-05-07" },
                        { opponent: "Islamabad United", result: "Won by 2 wickets", date: "2025-04-03" },
                        { opponent: "Lahore Qalandars", result: "No result (Rain)", date: "2025-05-01" },
                        { opponent: "Multan Sultans", result: "Won by 10 wickets", date: "2025-04-29" },
                        { opponent: "Peshawar Zalmi", result: "Won by 64 runs", date: "2025-04-27" },
                        { opponent: "Karachi Kings", result: "Won by 5 runs", date: "2025-04-25" },
                        { opponent: "Karachi Kings", result: "Lost by 56 runs", date: "2025-04-18" },
                        { opponent: "Lahore Qalandars", result: "Lost by 79 runs", date: "2025-04-13" },
                        { opponent: "Peshawar Zalmi", result: "Won by 80 runs", date: "2025-04-18" }
                    ]
                },
                "Peshawar Zalmi": {
                    matches: 8,
                    wins: 4,
                    losses: 4,
                    points: 8,
                    nrr: "-0.082",
                    form: "LLWLWLWW",
                    recentMatches: [
                        { opponent: "Multan Sultans", result: "Won by 7 Wickets", date: "2025-05-05" },
                        { opponent: "Islamabad United", result: "Won by 6 wickets", date: "2025-05-02" },
                        { opponent: "Lahore Qalandars", result: "Won by 7 wickets", date: "2025-04-24" },
                        { opponent: "Quetta Gladiators", result: "Lost by 64 runs", date: "2025-04-27" },
                        { opponent: "Karachi Kings", result: "Lost by 2 wickets", date: "2025-04-21" },
                        { opponent: "Multan Sultans", result: "Won by 120 runs", date: "2025-04-19" },
                        { opponent: "Islamabad United", result: "Lost by 102 runs", date: "2025-04-14" },
                        { opponent: "Quetta Gladiators", result: "Lost by 80 runs", date: "2025-04-12" },
                    ]
                },
                "Multan Sultans": {
                    matches: 9,
                    wins: 1,
                    losses: 8,
                    points: 2,
                    nrr: "-2.708",
                    form: "LLLWLLLLL",
                    recentMatches: [
                        { opponent: "Peshawar Zalmi", result: "Lost by 7 Wickets", date: "2025-05-05" },
                        { opponent: "Karachi Kings", result: "Lost by 87 runs", date: "2025-05-01" },
                        { opponent: "Quetta Gladiators", result: "Lost by 10 wickets", date: "2025-04-29" },
                        { opponent: "Lahore Qalandars", result: "Lost by 5 wickets", date: "2025-04-26" },
                        { opponent: "Islamabad United", result: "Lost by 7 wickets", date: "2025-04-23" },
                        { opponent: "Lahore Qalandars", result: "Won by 33 runs", date: "2025-04-22" },
                        { opponent: "Peshawar Zalmi", result: "Lost by 120 runs", date: "2025-04-19" },
                        { opponent: "Islamabad United", result: "Lost by 47 runs", date: "2025-04-16" },
                        { opponent: "Karachi Kings", result: "Lost by 4 Wickets", date: "2025-04-12" }
                    ]
                }
            },
            headToHead: {
                "Multan Sultans-Peshawar Zalmi": {
                    total: 1,
                    matches: [
                        { date: "2025-04-19", result: "Peshawar Zalmi won by 120 runs", scores: "PZ: 227/7, MS: 107 all out" }
                    ]
                },
                "Islamabad United-Lahore Qalandars": {
                    total: 3,
                    matches: [
                        { date: "2025-04-30", result: "Lahore Qalandars won by 88 runs", scores: "LQ: 202/6, IU: 114 all out" },
                        { date: "2025-04-26", result: "Lahore Qalandars won by 5 wickets", scores: "IU: 185/6, LQ: 186/5" },
                        { date: "2025-04-11", result: "Islamabad United won by 8 wickets", scores: "LQ: 139/10, IU: 143/2" }
                    ]
                },
                "Karachi Kings-Multan Sultans": {
                    total: 2,
                    matches: [
                        { date: "2025-05-01", result: "Karachi Kings won by 87 runs", scores: "KK: 201/5, MS: 114 all out" },
                        { date: "2025-04-12", result: "Karachi Kings won by 4 wickets", scores: "MS: 234/3, KK: 236/6" }
                    ]
                },
                "Peshawar Zalmi-Quetta Gladiators": {
                    total: 2,
                    matches: [
                        { date: "2025-04-27", result: "Quetta Gladiators won by 64 runs", scores: "QG: 182/5, PZ: 118 all out" },
                        { date: "2025-04-12", result: "Quetta Gladiators won by 80 runs", scores: "QG: 216/3, PZ: 136 all out" }
                    ]
                },
                "Karachi Kings-Lahore Qalandars": {
                    total: 1,
                    matches: [
                        { date: "2025-04-15", result: "Lahore Qalandars won by 65 runs", scores: "LQ: 226/4, KK: 161 all out" }
                    ]
                },
                "Islamabad United-Multan Sultans": {
                    total: 2,
                    matches: [
                        { date: "2025-04-23", result: "Islamabad United won by 7 wickets", scores: "MS: 148/8, IU: 149/3" },
                        { date: "2025-04-16", result: "Islamabad United won by 47 runs", scores: "IU: 184/5, MS: 137 all out" }
                    ]
                },
                "Karachi Kings-Quetta Gladiators": {
                    total: 2,
                    matches: [
                        { date: "2025-04-25", result: "Quetta Gladiators won by 5 runs", scores: "QG: 170/7, KK: 165/8" },
                        { date: "2025-04-18", result: "Karachi Kings won by 56 runs", scores: "KK: 205/6, QG: 149 all out" }
                    ]
                },
                "Lahore Qalandars-Peshawar Zalmi": {
                    total: 1,
                    matches: [
                        { date: "2025-04-24", result: "Peshawar Zalmi won by 7 wickets", scores: "LQ: 172/6, PZ: 173/3" }
                    ]
                },
                "Islamabad United-Karachi Kings": {
                    total: 1,
                    matches: [
                        { date: "2025-04-20", result: "Islamabad United won by 6 wickets", scores: "KK: 165/7, IU: 166/4" }
                    ]
                },
                "Karachi Kings-Peshawar Zalmi": {
                    total: 1,
                    matches: [
                        { date: "2025-04-21", result: "Karachi Kings won by 2 wickets", scores: "PZ: 178/6, KK: 179/8" }
                    ]
                },
                "Lahore Qalandars-Multan Sultans": {
                    total: 1,
                    matches: [
                        { date: "2025-04-22", result: "Multan Sultans won by 33 runs", scores: "MS: 195/5, LQ: 162 all out" }
                    ]
                },
                "Islamabad United-Peshawar Zalmi": {
                    total: 2,
                    matches: [
                        { date: "2025-05-02", result: "Peshawar Zalmi won by 6 wickets", scores: "IU: 163/7, PZ: 164/4" },
                        { date: "2025-04-14", result: "Islamabad United won by 102 runs", scores: "IU: 254/4, PZ: 152 all out" }
                    ]
                },
                "Multan Sultans-Quetta Gladiators": {
                    total: 1,
                    matches: [
                        { date: "2025-04-29", result: "Quetta Gladiators won by 10 wickets", scores: "MS: 89 all out, QG: 90/0" }
                    ]
                },
                "Lahore Qalandars-Quetta Gladiators": {
                    total: 2,
                    matches: [
                        { date: "2025-05-01", result: "No result (Rain)", scores: "Match abandoned" },
                        { date: "2025-04-13", result: "Lahore Qalandars won by 79 runs", scores: "LQ: 242/5, QG: 163 all out" }
                    ]
                },
                "Islamabad United-Quetta Gladiators": {
                    total: 0,
                    matches: []
                }
            },
            venues: {
                "Lahore": {
                    matches: 11,
                    avgFirstInnings: 185,
                    avgSecondInnings: 162,
                    tossDecision: "72% elected to field first",
                    winningToss: "59% matches won by team winning toss"
                },
                "Karachi": {
                    matches: 5,
                    avgFirstInnings: 198,
                    avgSecondInnings: 184,
                    tossDecision: "80% elected to field first",
                    winningToss: "60% matches won by team winning toss"
                },
                "Multan": {
                    matches: 4,
                    avgFirstInnings: 168,
                    avgSecondInnings: 152,
                    tossDecision: "64% elected to field first",
                    winningToss: "52% matches won by team winning toss"
                },
                "Rawalpindi": {
                    matches: 4,
                    avgFirstInnings: 198,
                    avgSecondInnings: 178,
                    tossDecision: "75% elected to field first",
                    winningToss: "50% matches won by team winning toss"
                }
            }
        };

        // Function to update analysis breakdown
        function updateAnalysisBreakdown(match) {
            const team1 = match.team1;
            const team2 = match.team2;
            const venue = match.venue;

            // Get team data
            const team1Data = pslData.teams[team1];
            const team2Data = pslData.teams[team2];

            // Get head-to-head data
            const h2hKey = [team1, team2].sort().join('-');
            const h2hData = pslData.headToHead[h2hKey] || { total: 0, matches: [] };

            // Calculate wins for each team
            let team1Wins = 0;
            let team2Wins = 0;
            
            if (h2hData.matches && h2hData.matches.length > 0) {
                h2hData.matches.forEach(match => {
                    if (match.result.includes(team1) && match.result.includes("won")) {
                        team1Wins++;
                    } else if (match.result.includes(team2) && match.result.includes("won")) {
                        team2Wins++;
                    }
                });
            }

            // Get venue data
            const venueData = pslData.venues[venue] || pslData.venues["Lahore"]; // Default to Lahore if venue not found

            // Update Key Factors tab
            document.getElementById('h2h-current-season').innerHTML = `<span style="color: #2B6735;">${team1} won ${team1Wins}, ${team2} won ${team2Wins}</span>`;
            document.getElementById('toss-advantage').innerHTML = `<span style="color: #B27F35;">${venueData.winningToss}</span>`;
            document.getElementById('win-percentage').innerHTML = `<span style="color: #2B6735;">${team1}: ${(team1Data.wins/team1Data.matches*100).toFixed(1)}% | ${team2}: ${(team2Data.wins/team2Data.matches*100).toFixed(1)}%</span>`;
            document.getElementById('venue-performance').innerHTML = `<span style="color: #2B6735;">See venue analysis tab for details</span>`;
            // Update Recent Form section to use form indicators
            // Get fresh form data if available
            const team1Form = team1Data.form.slice(-5) || (team1Data.recentMatches || []).map(m => m.result.includes('Won') ? 'W' : 'L').join('');
            const team2Form = team2Data.form.slice(-5) || (team2Data.recentMatches || []).map(m => m.result.includes('Won') ? 'W' : 'L').join('');
            
            let recentFormHtml = '';
            
            // Add form indicators for team 1
            recentFormHtml += `<span>${team1}: </span>`;
            for (let i = 0; i < team1Form.length; i++) {
                const result = team1Form[i];
                if (result === 'W') {
                    recentFormHtml += `<span class="form-indicator win" title="Win">W</span>`;
                } else if (result === 'L') {
                    recentFormHtml += `<span class="form-indicator loss" title="Loss">L</span>`;
                } else {
                    recentFormHtml += `<span class="form-indicator no-result" title="No Result">N</span>`;
                }
            }
            
            recentFormHtml += `&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;<span>${team2}: </span>`;
            
            // Add form indicators for team 2
            for (let i = 0; i < team2Form.length; i++) {
                const result = team2Form[i];
                if (result === 'W') {
                    recentFormHtml += `<span class="form-indicator win" title="Win">W</span>`;
                } else if (result === 'L') {
                    recentFormHtml += `<span class="form-indicator loss" title="Loss">L</span>`;
                } else {
                    recentFormHtml += `<span class="form-indicator no-result" title="No Result">N</span>`;
                }
            }
            
            document.getElementById('recent-form').innerHTML = recentFormHtml;
            document.getElementById('key-players-status').innerHTML = `<span style="color: #2B6735;">All players available unless otherwise noted</span>`;

            // Update Venue Analysis tab
            document.getElementById('venue-name').textContent = `${venue} Cricket Stadium Stats`;
            document.getElementById('avg-first-innings').innerHTML = `<span style="color: #B27F35;">${venueData.avgFirstInnings} runs</span>`;
            document.getElementById('avg-second-innings').innerHTML = `<span style="color: #B27F35;">${venueData.avgSecondInnings} runs</span>`;
            document.getElementById('toss-decision-trend').innerHTML = `<span style="color: #B27F35;">${venueData.tossDecision}</span>`;

            // Update Current Form tab
            document.getElementById('team1-form-title').textContent = `${team1} - Recent Form`;
            document.getElementById('team2-form-title').textContent = `${team2} - Recent Form`;

            // Generate form HTML for team 1
            let team1FormHtml = '';
            if (team1Data && team1Data.recentMatches) {
                team1Data.recentMatches.forEach(match => {
                    const resultClass = match.result.includes('Won') ? 'win' : match.result.includes('Lost') ? 'loss' : '';
                    const resultText = match.result.includes('Won') ? 'win' : match.result.includes('Lost') ? 'loss' : '';
                    team1FormHtml += `
                        <div class="form-match ${resultClass}">
                            <span>vs ${match.opponent} (${match.date})</span>
                            <span class="result ${resultText}">${match.result}</span>
                        </div>
                    `;
                });
            }

            // Generate form HTML for team 2
            let team2FormHtml = '';
            if (team2Data && team2Data.recentMatches) {
                team2Data.recentMatches.forEach(match => {
                    const resultClass = match.result.includes('Won') ? 'win' : match.result.includes('Lost') ? 'loss' : '';
                    const resultText = match.result.includes('Won') ? 'win' : match.result.includes('Lost') ? 'loss' : '';
                    team2FormHtml += `
                        <div class="form-match ${resultClass}">
                            <span>vs ${match.opponent} (${match.date})</span>
                            <span class="result ${resultText}">${match.result}</span>
                        </div>
                    `;
                });
            }

            document.getElementById('team1-recent-form').innerHTML = team1FormHtml;
            document.getElementById('team2-recent-form').innerHTML = team2FormHtml;
            
            // Update Points Table tab
            updatePointsTable();

            // Update additional match data
            updateAdditionalMatchData(team1, team2, venue);
        }
        
        // Function to update the points table
        function updatePointsTable() {
            const pointsTableBody = document.getElementById('points-table-body');
            if (!pointsTableBody) return;
            
            // Clear existing rows
            pointsTableBody.innerHTML = '';
            
            // Get all teams data
            const teams = pslData.teams;
            if (!teams) return;
            
            // Convert teams object to array for sorting
            const teamsArray = Object.entries(teams).map(([name, data]) => ({
                name,
                ...data
            }));
            
            // Sort teams by points, then by NRR
            teamsArray.sort((a, b) => {
                if (a.points !== b.points) {
                    return b.points - a.points;
                }
                
                // Convert NRR strings to numbers for proper comparison
                const nrrA = parseFloat(a.nrr) || 0;
                const nrrB = parseFloat(b.nrr) || 0;
                
                return nrrB - nrrA;
            });
            
            // Create a row for each team
            teamsArray.forEach((team, index) => {
                const row = document.createElement('tr');
                
                // Add playoff position class for top 4 teams
                if (index < 4) {
                    row.classList.add('playoff-position');
                }
                
                // Convert NRR string to number
                const nrr = parseFloat(team.nrr) || 0;
                const nrrClass = nrr >= 0 ? 'nrr-positive' : 'nrr-negative';
                
                // Format the team logo and name
                const teamLogo = `<img src="logo/${team.name.toLowerCase().replace(' ', '_')}.png" alt="${team.name}" class="points-table-team-logo" />`;
                
                // Format the form icons for the last 5 matches
                let formHtml = '';
                const formData = team.form ? team.form.slice(-5) : '';
                
                for (let i = 0; i < formData.length; i++) {
                    const result = formData[i];
                    if (result === 'W') {
                        formHtml += `<span class="table-form-indicator win" title="Win">W</span>`;
                    } else if (result === 'L') {
                        formHtml += `<span class="table-form-indicator loss" title="Loss">L</span>`;
                    } else if (result === 'N') {
                        formHtml += `<span class="table-form-indicator no-result" title="No Result">N</span>`;
                    }
                }
                
                // Create the row HTML
                row.innerHTML = `
                    <td>${teamLogo}${team.name}</td>
                    <td>${team.matches || 0}</td>
                    <td>${team.wins || 0}</td>
                    <td>${team.losses || 0}</td>
                    <td>${(team.matches - team.wins - team.losses) || 0}</td>
                    <td>${team.points || 0}</td>
                    <td class="${nrrClass}">${team.nrr || '0.000'}</td>
                    <td>${formHtml}</td>
                `;
                
                pointsTableBody.appendChild(row);
            });
        }

        // Initialize when page loads
        window.onload = function() {
            // First, try to populate matches
            populateMatchSelector();
            populateUpcomingMatches();
            
            // Add event listener for prediction button
            document.getElementById('predict-btn').addEventListener('click', function() {
                // Get selected match ID from the selected button
                const selectedButton = document.querySelector('.match-button.selected');
                if (selectedButton) {
                    generatePrediction(selectedButton.dataset.matchId);
                } else {
                    alert('Please select a match first!');
                }
            });
            
            // Initialize the points table
            updatePointsTable();
            
            // Check if the match buttons are populated
            const matchButtons = document.getElementById('quick-match-buttons');
            if (matchButtons && (!matchButtons.children || matchButtons.children.length === 0)) {
                console.warn("No match buttons were generated on initial load - showing fix button");
                
                // Show the fix data button
                const fixDataBtn = document.getElementById('fix-data-btn');
                if (fixDataBtn) {
                    fixDataBtn.style.display = 'block';
                    
                    // Add event listener to the fix button
                    fixDataBtn.addEventListener('click', function() {
                        // Apply hardcoded updates
                        if (window.hardcodedUpdates && typeof window.hardcodedUpdates.applyUpdates === 'function') {
                            try {
                                // Get base data or use default
                                const baseData = window.pslDataFetcher && typeof window.pslDataFetcher.getCachedData === 'function' ?
                                    window.pslDataFetcher.getCachedData() : window.DEFAULT_PSL_DATA;
                                
                                // Apply hardcoded updates
                                const updatedData = window.hardcodedUpdates.applyUpdates(baseData);
                                
                                // Manually update global objects
                                window.pslData = {
                                    teams: updatedData.teams,
                                    headToHead: updatedData.headToHead,
                                    venues: updatedData.venues
                                };
                                
                                window.allMatches = updatedData.matches;
                                
                                // Re-populate UI
                                populateMatchSelector();
                                populateUpcomingMatches();
                                updatePointsTable();
                                
                                // Try to use the debugLogger's fix function if available
                                if (window.debugLogger && typeof window.debugLogger.fixDataIssues === 'function') {
                                    window.debugLogger.fixDataIssues();
                                }
                                
                                // Hide the button after fixing
                                this.style.display = 'none';
                                
                                alert("Data has been updated successfully! Upcoming matches should now appear.");
                            } catch (error) {
                                console.error("Error fixing data:", error);
                                alert("There was an error fixing the data. Please try refreshing the page.");
                            }
                        } else {
                            alert("Required data fixing modules not available. Please refresh the page.");
                        }
                    });
                }
            }
        };
    </script>

    <!-- PSL Data Fetching and Integration Scripts -->
    <script src="js/default-data.js"></script>
    <script src="js/cors-proxy.js"></script>
    <script src="js/debug-logger.js"></script>
    <script src="js/hardcoded-updates.js"></script>
    <script src="js/direct-scraper.js"></script>
    <script src="js/data-fetcher.js"></script>
    <script src="js/data-integration.js"></script>\n    <script src="js/match-helper.js"></script>
    
    <!-- Script to initialize data fetching on page load -->
    <script>
        // Run data integration when the page has fully loaded
        window.addEventListener('load', function() {
            // Attempt to integrate data
            if (window.pslDataIntegration && typeof window.pslDataIntegration.integrate === 'function') {
                console.log("Initializing PSL data fetching and integration...");
                window.pslDataIntegration.integrate();
                
                // Set up regular refresh for long-duration sessions
                setInterval(function() {
                    if (window.pslDataIntegration && typeof window.pslDataIntegration.integrate === 'function') {
                        console.log("Refreshing PSL data...");
                        window.pslDataIntegration.integrate();
                    }
                }, 3600000); // Refresh every hour (3600000 ms)
            } else {
                console.error("PSL data integration not available");
            }
        });
        
        // Add a status indicator to show when data was last fetched
        document.addEventListener('DOMContentLoaded', function() {
            const container = document.querySelector('.container');
            if (container) {
                const statusDiv = document.createElement('div');
                statusDiv.id = 'data-status';
                statusDiv.style.textAlign = 'center';
                statusDiv.style.fontSize = '12px';
                statusDiv.style.color = '#666';
                statusDiv.style.padding = '10px';
                statusDiv.style.marginTop = '20px';
                statusDiv.style.borderTop = '1px solid #eee';
                
                // Add a refresh button to manually force a data refresh
                const refreshButton = document.createElement('button');
                refreshButton.textContent = 'Clear Cache & Update';
                refreshButton.style.marginLeft = '10px';
                refreshButton.style.padding = '3px 8px';
                refreshButton.style.backgroundColor = '#2B6735';
                refreshButton.style.color = 'white';
                refreshButton.style.border = 'none';
                refreshButton.style.borderRadius = '3px';
                refreshButton.style.cursor = 'pointer';
                refreshButton.style.fontSize = '12px';
                
                // Add direct scrape button
                const directScrapeButton = document.createElement('button');
                directScrapeButton.textContent = 'Force Direct Scrape';
                directScrapeButton.style.marginLeft = '10px';
                directScrapeButton.style.padding = '3px 8px';
                directScrapeButton.style.backgroundColor = '#B27F35';
                directScrapeButton.style.color = 'white';
                directScrapeButton.style.border = 'none';
                directScrapeButton.style.borderRadius = '3px';
                directScrapeButton.style.cursor = 'pointer';
                directScrapeButton.style.fontSize = '12px';
                
                // Add use hardcoded data button
                const useHardcodedButton = document.createElement('button');
                useHardcodedButton.textContent = 'Use Most recent Data';
                useHardcodedButton.style.marginLeft = '10px';
                useHardcodedButton.style.padding = '3px 8px';
                useHardcodedButton.style.backgroundColor = '#d32f2f';
                useHardcodedButton.style.color = 'white';
                useHardcodedButton.style.border = 'none';
                useHardcodedButton.style.borderRadius = '3px';
                useHardcodedButton.style.cursor = 'pointer';
                useHardcodedButton.style.fontSize = '12px';
                
                refreshButton.addEventListener('click', function() {
                    if (window.pslDataFetcher && typeof window.pslDataFetcher.forceRefresh === 'function') {
                        statusDiv.textContent = 'Refreshing data...';
                        window.pslDataFetcher.forceRefresh();
                        if (window.pslDataIntegration && typeof window.pslDataIntegration.integrate === 'function') {
                            window.pslDataIntegration.integrate();
                        }
                    }
                });
                
                directScrapeButton.addEventListener('click', function() {
                    if (window.directScraper && typeof window.directScraper.scrapePointsTable === 'function') {
                        statusDiv.textContent = 'Directly scraping latest data...';
                        window.directScraper.scrapePointsTable().then(pointsTable => {
                            if (pointsTable && Object.keys(pointsTable).length > 0) {
                                // Get cached data
                                const cachedData = window.pslDataFetcher.getCachedData() || window.DEFAULT_PSL_DATA;
                                
                                // Update with direct data
                                window.directScraper.updatePSLData(cachedData).then(updatedData => {
                                    // Store the updated data
                                    localStorage.setItem('psl_2025_data', JSON.stringify(updatedData));
                                    localStorage.setItem('psl_2025_last_fetch', Date.now().toString());
                                    
                                    // Integrate the new data
                                    if (window.pslDataIntegration && typeof window.pslDataIntegration.integrate === 'function') {
                                        window.pslDataIntegration.integrate();
                                    }
                                    
                                    statusDiv.textContent = 'Data successfully updated via direct scraping!';
                                    statusDiv.appendChild(refreshButton);
                                    statusDiv.appendChild(directScrapeButton);
                                    statusDiv.appendChild(useHardcodedButton);
                                });
                            } else {
                                statusDiv.textContent = 'Direct scraping failed. Please try again later.';
                                statusDiv.appendChild(refreshButton);
                                statusDiv.appendChild(directScrapeButton);
                                statusDiv.appendChild(useHardcodedButton);
                            }
                        }).catch(error => {
                            console.error("Direct scraping error:", error);
                            statusDiv.textContent = 'Error during direct scraping. Please try again.';
                            statusDiv.appendChild(refreshButton);
                            statusDiv.appendChild(directScrapeButton);
                            statusDiv.appendChild(useHardcodedButton);
                        });
                    }
                });
                
                useHardcodedButton.addEventListener('click', function() {
                    if (window.hardcodedUpdates && typeof window.hardcodedUpdates.applyUpdates === 'function') {
                        statusDiv.textContent = 'Applying latest May 8th data...';
                        
                        try {
                            // Get base data
                            const baseData = window.pslDataFetcher.getCachedData() || window.DEFAULT_PSL_DATA;
                            
                            // Apply hardcoded updates
                            const updatedData = window.hardcodedUpdates.applyUpdates(baseData);
                            
                            // Store the updated data
                            localStorage.setItem('psl_2025_data', JSON.stringify(updatedData));
                            localStorage.setItem('psl_2025_last_fetch', Date.now().toString());
                            
                            // Integrate the new data
                            if (window.pslDataIntegration && typeof window.pslDataIntegration.integrate === 'function') {
                                window.pslDataIntegration.integrate();
                            }
                            
                            statusDiv.textContent = 'Applied latest May 8th data successfully!';
                            statusDiv.appendChild(refreshButton);
                            statusDiv.appendChild(directScrapeButton);
                            statusDiv.appendChild(useHardcodedButton);
                        } catch (error) {
                            console.error("Error applying hardcoded updates:", error);
                            statusDiv.textContent = 'Error applying May 8th data. Please try again.';
                            statusDiv.appendChild(refreshButton);
                            statusDiv.appendChild(directScrapeButton);
                            statusDiv.appendChild(useHardcodedButton);
                        }
                    }
                });
                
                statusDiv.textContent = 'Live data from Cricinfo - Checking for updates...';
                statusDiv.appendChild(refreshButton);
                statusDiv.appendChild(directScrapeButton);
                statusDiv.appendChild(useHardcodedButton);
                container.appendChild(statusDiv);
                
                // Update the status with the last fetch time
                setInterval(function() {
                    if (window.pslDataFetcher && typeof window.pslDataFetcher.getLastFetchTime === 'function') {
                        const lastFetch = window.pslDataFetcher.getLastFetchTime();
                        if (lastFetch) {
                            statusDiv.textContent = `Live data from Cricinfo - Last updated: ${lastFetch.toLocaleString()}`;
                            statusDiv.appendChild(refreshButton);
                            statusDiv.appendChild(directScrapeButton);
                            statusDiv.appendChild(useHardcodedButton);
                        }
                    }
                }, 10000); // Check every 10 seconds
            }
        });
    </script>
</body>
</html>
