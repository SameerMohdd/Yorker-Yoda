<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yorker Yoda - PSL 2025 Match Predictor</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: white;
            padding: 20px;
            margin: 0;
            min-height: 100vh;
            color: #333;
        }
        .container {
            max-width: 1300px;
            margin: 0 auto;
            background-color: white;
            padding: 10px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 2px solid #B27F35;
        }
        .inner-content {
            padding-right: 20px; /* Try increasing to 15px or 20px if needed */
        }
        header {
            text-align: center;
            background: linear-gradient(to right, #2B6735, #B27F35);
            padding: 20px;
            border-radius: 10px;
            color: white;
            position: relative;
            overflow: hidden;
            margin-bottom: 30px;
        }
        .header-content {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            position: relative;
            z-index: 2;
        }
        .cricket-icons {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 1;
            opacity: 0.1;
        }
        .cricket-icons::before {
            content: 'üèè';
            position: absolute;
            font-size: 80px;
            left: 20px;
            top: 50%;
            transform: translateY(-50%) rotate(-45deg);
        }
        .cricket-icons::after {
            content: 'üèè';
            position: absolute;
            font-size: 80px;
            right: 20px;
            top: 50%;
            transform: translateY(-50%) rotate(45deg);
        }
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .yoda-emoji {
            font-size: 60px;
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .yoda-emoji::before {
            content: 'üèè';
            font-size: 40px;
        }
        .yoda-emoji::after {
            content: 'üèè';
            font-size: 40px;
        }
        h1 {
            color: #fff;
            margin: 0;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .tagline {
            color: #fff;
            font-style: italic;
            margin: 5px 0;
            opacity: 0.9;
            font-size: 1.2em;
        }
        .match-selector {
            margin: 20px 0;
            background: rgba(43, 103, 53, 0.1);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #B27F35;
        }
        select {
            width: 100%;
            padding: 12px;
            border: 2px solid #B27F35;
            border-radius: 8px;
            font-size: 16px;
            margin-top: 8px;
            background: white;
            color: #2B6735;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        select:hover {
            border-color: #2B6735;
        }
        .predict-btn {
            background: linear-gradient(to right, #B27F35, #8c6428);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 18px;
            cursor: pointer;
            position: relative;
            margin: 20px auto;
            display: block;
            transform: skew(-20deg);
            border-radius: 5px 50px 50px 5px;
            box-shadow: 3px 3px 6px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            width: 200px;
        }
        .predict-btn span {
            display: inline-block;
            transform: skew(20deg);
        }
        .predict-btn::after {
            content: '';
            position: absolute;
            right: -15px;
            top: 50%;
            transform: translateY(-50%);
            width: 15px;
            height: 80%;
            background: #8c6428;
            border-radius: 0 5px 5px 0;
        }
        .predict-btn:hover {
            transform: skew(-20deg) translateY(-2px);
            box-shadow: 4px 4px 8px rgba(0,0,0,0.3);
        }
        #match-details {
            margin-top: 20px;
            padding: 20px;
            background: linear-gradient(135deg, rgba(43, 103, 53, 0.1), rgba(178, 127, 53, 0.1));
            border-radius: 12px;
            border: 1px solid #B27F35;
        }
        
        #head-to-head {
            font-weight: bold;
            color: #2B6735;
        }
        .team-logos {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 20px 0;
        }
        .team-logo {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            border: 3px solid #B27F35;
            transition: transform 0.3s ease;
            overflow: hidden;
            background: white;
            padding: 5px;
        }
        .team-logo img {
            width: 90%;
            height: 90%;
            object-fit: contain;
        }
        .team-logo:hover {
            transform: scale(1.05);
        }
        .loading-spinner {
            display: none;
            width: 50px;
            height: 50px;
            border: 5px solid #B27F35;
            border-top: 5px solid #2B6735;
            border-radius: 50%;
            margin: 20px auto;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .prediction-result {
            margin-top: 20px;
            padding: 25px;
            background: linear-gradient(135deg, rgba(43, 103, 53, 0.1), rgba(178, 127, 53, 0.1));
            border-radius: 12px;
            border-left: 5px solid #2B6735;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            display: none;
        }
        .quote {
            font-style: italic;
            text-align: center;
            color: #555;
            margin: 20px 0;
            padding: 15px;
            background: rgba(255,255,255,0.8);
            border-radius: 8px;
            border: 1px solid #B27F35;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 20px;
        }
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            border: 1px solid #B27F35;
            transition: transform 0.3s ease;
        }
        .stat-card:hover {
            transform: translateY(-2px);
        }
        .stat-card h4 {
            margin: 0 0 10px 0;
            color: #2B6735;
            border-bottom: 2px solid #B27F35;
            padding-bottom: 5px;
        }
        #weather-selector {
            background: linear-gradient(135deg, rgba(43, 103, 53, 0.1), rgba(178, 127, 53, 0.1));
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #B27F35;
            margin-top: 20px;
            text-align: center;
        }
        #weather {
            background: white;
            border: 2px solid #B27F35;
            padding: 10px;
            width: 200px;
            border-radius: 8px;
            margin: 10px 0;
            color: #2B6735;
        }
        label {
            color: #2B6735;
            font-weight: bold;
        }
        
        /* Analysis Breakdown Styles */
        .tabs-container {
            margin-top: 20px;
        }
        
        .tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            overflow-x: auto;
        }
        
        .tab-button {
            padding: 12px 24px;
            border: none;
            background: #f0f0f0;
            color: #2B6735;
            cursor: pointer;
            border-radius: 8px 8px 0 0;
            font-weight: bold;
            transition: all 0.3s ease;
            white-space: nowrap;
        }
        
        .tab-button.active {
            background: #2B6735;
            color: white;
            border-bottom: 3px solid #B27F35;
        }
        
        .tab-button:hover:not(.active) {
            background: #e0e0e0;
        }
        
        .tab-content {
            display: none;
            padding: 20px;
            background: white;
            border: 1px solid #B27F35;
            border-radius: 0 8px 8px 8px;
            min-height: 300px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .analysis-table table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .analysis-table td {
            padding: 12px;
            border-bottom: 1px solid #eee;
        }
        
        .factor-label {
            font-weight: bold;
            color: #2B6735;
            width: 40%;
        }
        
        .h2h-overview {
            display: flex;
            justify-content: space-around;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, rgba(43, 103, 53, 0.1), rgba(178, 127, 53, 0.1));
            border-radius: 10px;
        }
        
        #head-to-head h4 {
            color: #2B6735;
            border-bottom: 2px solid #B27F35;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        
        .h2h-stat {
            text-align: center;
        }
        
        .h2h-number {
            display: block;
            font-size: 36px;
            font-weight: bold;
            color: #2B6735;
        }
        
        .h2h-label {
            display: block;
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }
        
        .team1-stat .h2h-number {
            color: #2B6735;
        }
        
        .team2-stat .h2h-number {
            color: #B27F35;
        }
        
        .recent-matches {
            margin-top: 20px;
        }
        
        .match-result {
            padding: 10px;
            margin: 10px 0;
            background: #f9f9f9;
            border-left: 4px solid #B27F35;
            border-radius: 4px;
        }
        
        .venue-stats table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .venue-stats td {
            padding: 12px;
            border-bottom: 1px solid #eee;
        }
        
        .form-tables {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .team-form {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 8px;
        }
        
        .team-form h4 {
            margin-top: 0;
            color: #2B6735;
            border-bottom: 2px solid #B27F35;
            padding-bottom: 10px;
        }
        
        .form-match {
            padding: 8px;
            margin: 8px 0;
            background: white;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .form-match.win {
            border-left: 4px solid #2B6735;
        }
        
        .form-match.loss {
            border-left: 4px solid #d32f2f;
        }
        
        .form-match .result {
            font-weight: bold;
        }
        
        .form-match .result.win {
            color: #2B6735;
        }
        
        .form-match .result.loss {
            color: #d32f2f;
        }
        
        @media (max-width: 768px) {
            .form-tables {
                grid-template-columns: 1fr;
            }
            
            .tabs {
                flex-wrap: wrap;
            }
            
            .tab-button {
                flex: 1;
                min-width: 120px;
            }
        }
</style>
</head>
<body>
    <div class="container">
        <div class="inner-content">
          <header>
            <div class="cricket-icons"></div>
            <div class="header-content">
              <div class="logo">
                <div class="yoda-emoji">üßô</div>
              </div>
              <div>
                <h1>Winning Yoda</h1>
                <p class="tagline">PSL Match Predictor</p>
              </div>
            </div>
          </header>
          <!-- Add more content here if needed -->
        </div>
      </div>

        <div class="match-selector">
            <label for="match-select">Select Upcoming Match:</label>
            <select id="match-select">
                <option value="">-- Select a Match --</option>
            </select>
        </div>

        <div id="match-details" style="display: none;">
            <h3 id="match-title">Match Details</h3>
            <div class="team-logos">
                <div>
                    <div id="team1-logo" class="team-logo"></div>
                    <p id="team1-name" style="text-align: center; font-weight: bold;"></p>
                </div>
                <div style="font-weight: bold; font-size: 24px;">VS</div>
                <div>
                    <div id="team2-logo" class="team-logo"></div>
                    <p id="team2-name" style="text-align: center; font-weight: bold;"></p>
                </div>
            </div>
            <div style="margin-top: 20px;">
                <p><strong>Date:</strong> <span id="match-date"></span></p>
                <p><strong>Time:</strong> <span id="match-time"></span></p>
                <p><strong>Venue:</strong> <span id="match-venue"></span></p>
                <p><strong>Head to Head:</strong> <span id="head-to-head"></span></p>
            </div>
        </div>

        <div id="analysis-breakdown" style="display: none;">
            <h3 style="margin-top: 30px; color: #2B6735; border-bottom: 2px solid #B27F35; padding-bottom: 10px;">üìä Analysis Breakdown</h3>
            
            <div class="tabs-container">
                <div class="tabs">
                    <button class="tab-button active" data-tab="key-factors">Key Factors</button>
                    <button class="tab-button" data-tab="venue-analysis">Venue Analysis</button>
                    <button class="tab-button" data-tab="current-form">Current Form</button>
                </div>
                
                <div class="tab-content active" id="key-factors">
                    <div class="analysis-table">
                        <h4>Prediction Factors</h4>
                        <table>
                            <tr>
                                <td class="factor-label">Head-to-Head in PSL 2025</td>
                                <td id="h2h-current-season"></td>
                            </tr>
                            <tr>
                                <td class="factor-label">Toss Advantage at Venue</td>
                                <td id="toss-advantage"></td>
                            </tr>
                            <tr>
                                <td class="factor-label">PSL 2025 Win Percentage</td>
                                <td id="win-percentage"></td>
                            </tr>
                            <tr>
                                <td class="factor-label">Performance at Venue</td>
                                <td id="venue-performance"></td>
                            </tr>
                            <tr>
                                <td class="factor-label">Recent Form (Last 5 matches)</td>
                                <td id="recent-form"></td>
                            </tr>
                            <tr>
                                <td class="factor-label">Key Players Availability</td>
                                <td id="key-players-status"></td>
                            </tr>
                        </table>
                    </div>
                </div>
                
                <div class="tab-content" id="venue-analysis">
                    <div class="venue-stats">
                        <h4 id="venue-name">Venue Stats</h4>
                        <table>
                            <tr>
                                <td class="factor-label">Average 1st Innings Score</td>
                                <td id="avg-first-innings"></td>
                            </tr>
                            <tr>
                                <td class="factor-label">Average 2nd Innings Score</td>
                                <td id="avg-second-innings"></td>
                            </tr>
                            <tr>
                                <td class="factor-label">Toss Decision Trend</td>
                                <td id="toss-decision-trend"></td>
                            </tr>
                            <tr>
                                <td class="factor-label">Team 1 at this venue (PSL 2025)</td>
                                <td id="team1-venue-record"></td>
                            </tr>
                            <tr>
                                <td class="factor-label">Team 2 at this venue (PSL 2025)</td>
                                <td id="team2-venue-record"></td>
                            </tr>
                        </table>
                    </div>
                </div>
                
                <div class="tab-content" id="current-form">
                    <div class="form-tables">
                        <div class="team-form">
                            <h4 id="team1-form-title">Team 1 - Recent Form</h4>
                            <div id="team1-recent-form"></div>
                        </div>
                        <div class="team-form">
                            <h4 id="team2-form-title">Team 2 - Recent Form</h4>
                            <div id="team2-recent-form"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="weather-selector" style="display: none;">
            <label for="weather">Select Weather Condition:</label><br>
            <select id="weather">
                <option value="Clear">Clear</option>
                <option value="Cloudy">Cloudy</option>
                <option value="Light Rain">Light Rain</option>
                <option value="Hot and Humid">Hot and Humid</option>
            </select>
            <br>
            <button id="predict-btn" class="predict-btn"><span>Predict</span></button>
        </div>

        <div id="loading" class="loading-spinner"></div>

        <div id="prediction-result" class="prediction-result">
            <div id="prediction-text"></div>
            <div id="yoda-quote" class="quote"></div>
            <div class="stats-grid">
                <div class="stat-card">
                    <h4>Win Probability</h4>
                    <div id="win-probability"></div>
                </div>
                <div class="stat-card">
                    <h4>Key Player</h4>
                    <div id="key-player"></div>
                </div>
                <div class="stat-card">
                    <h4>Expected Score</h4>
                    <div id="expected-score"></div>
                </div>
                <div class="stat-card">
                    <h4>Toss Impact</h4>
                    <div id="toss-impact"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Team data with details
        const teamData = {
            "islamabad united": { code: "IU", color: "#A81D33" },
            "peshawar zalmi": { code: "PZ", color: "#FFC700" },
            "quetta gladiators": { code: "QG", color: "#4B0082" },
            "lahore qalandars": { code: "LQ", color: "#00A651" },
            "karachi kings": { code: "KK", color: "#1C3C7C" },
            "multan sultans": { code: "MS", color: "#00B5AF" }
        };

        // All PSL 2025 matches - Updated with remaining games
        const allMatches = {
            "Match23": {
                team1: "islamabad united",
                team2: "quetta gladiators",
                date: "2025-05-03",
                time: "8:00 PM",
                venue: "Lahore"
            },
            "Match24": {
                team1: "lahore qalandars",
                team2: "karachi kings",
                date: "2025-05-04",
                time: "8:00 PM",
                venue: "Lahore"
            },
            "Match25": {
                team1: "multan sultans",
                team2: "peshawar zalmi",
                date: "2025-05-05",
                time: "8:00 PM",
                venue: "Multan"
            },
            "Match26": {
                team1: "islamabad united",
                team2: "quetta gladiators",
                date: "2025-05-06",
                time: "8:00 PM",
                venue: "Rawalpindi"
            },
            "Match27": {
                team1: "peshawar zalmi",
                team2: "karachi kings",
                date: "2025-05-07",
                time: "8:00 PM",
                venue: "Rawalpindi"
            },
            "Match28": {
                team1: "lahore qalandars",
                team2: "peshawar zalmi",
                date: "2025-05-08",
                time: "8:00 PM",
                venue: "Rawalpindi"
            },
            "Match29": {
                team1: "multan sultans",
                team2: "islamabad united",
                date: "2025-05-09",
                time: "8:00 PM",
                venue: "Multan"
            },
            "Match30": {
                team1: "karachi kings",
                team2: "quetta gladiators",
                date: "2025-05-10",
                time: "8:00 PM",
                venue: "Karachi"
            },
            "Match31": {
                team1: "lahore qalandars",
                team2: "multan sultans",
                date: "2025-05-11",
                time: "3:00 PM",
                venue: "Lahore"
            },
            "Match32": {
                team1: "peshawar zalmi",
                team2: "islamabad united",
                date: "2025-05-11",
                time: "8:00 PM",
                venue: "Lahore"
            },
            "Match33": {
                team1: "karachi kings",
                team2: "lahore qalandars",
                date: "2025-05-12",
                time: "8:00 PM",
                venue: "Lahore"
            },
            "Match34": {
                team1: "quetta gladiators",
                team2: "multan sultans",
                date: "2025-05-12",
                time: "8:00 PM",
                venue: "Lahore"
            },
            // Playoff matches
            "Qualifier": {
                team1: "TBD (1st)",
                team2: "TBD (2nd)",
                date: "2025-05-13",
                time: "8:00 PM",
                venue: "Rawalpindi"
            },
            "Eliminator1": {
                team1: "TBD (3rd)",
                team2: "TBD (4th)",
                date: "2025-05-14",
                time: "8:00 PM",
                venue: "Lahore"
            },
            "Eliminator2": {
                team1: "TBD",
                team2: "TBD",
                date: "2025-05-16",
                time: "8:00 PM",
                venue: "Lahore"
            },
            "Final": {
                team1: "TBD",
                team2: "TBD",
                date: "2025-05-18",
                time: "8:00 PM",
                venue: "Lahore"
            }
        };

        // Get today's date at start of day
        function getTodayStart() {
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            return today;
        }

        // Function to get upcoming matches
        function getUpcomingMatches() {
            const today = getTodayStart();
            const upcomingMatches = {};
            
            for (const [key, match] of Object.entries(allMatches)) {
                const matchDate = new Date(match.date);
                if (matchDate >= today) {
                    upcomingMatches[key] = match;
                }
            }
            
            return upcomingMatches;
        }

        // Function to populate match selector
        function populateMatchSelector() {
            const matchSelect = document.getElementById('match-select');
            matchSelect.innerHTML = '<option value="">-- Select a Match --</option>';
            
            const upcomingMatches = getUpcomingMatches();
            for (const [key, match] of Object.entries(upcomingMatches)) {
                const matchDate = new Date(match.date);
                const today = new Date();
                const tomorrow = new Date(today);
                tomorrow.setDate(tomorrow.getDate() + 1);
                
                const option = document.createElement('option');
                option.value = key;
                
                // Format date string
                const dateStr = matchDate.toLocaleDateString('en-US', { 
                    month: 'long', 
                    day: 'numeric'
                });
                
                // Add today/tomorrow label
                let timeLabel = '';
                if (matchDate.toDateString() === today.toDateString()) {
                    timeLabel = ' (Today)';
                } else if (matchDate.toDateString() === tomorrow.toDateString()) {
                    timeLabel = ' (Tomorrow)';
                }
                
                option.textContent = `${match.team1} vs ${match.team2} - ${dateStr}${timeLabel}`;
                matchSelect.appendChild(option);
            }
        }

        // Function to show match details
        function showMatchDetails(matchId) {
            const matchDetails = document.getElementById('match-details');
            const analysisBreakdown = document.getElementById('analysis-breakdown');
            const weatherSelector = document.getElementById('weather-selector');
            const predictionResult = document.getElementById('prediction-result');

            if (!matchId) {
                matchDetails.style.display = 'none';
                analysisBreakdown.style.display = 'none';
                weatherSelector.style.display = 'none';
                predictionResult.style.display = 'none';
                return;
            }

            const match = allMatches[matchId];
            if (!match) return;

            // Update match details
            document.getElementById('match-title').textContent = `${match.team1} vs ${match.team2}`;
            
            const team1Logo = document.getElementById('team1-logo');
            const team2Logo = document.getElementById('team2-logo');
            
            team1Logo.innerHTML = `<img src="logo/${match.team1.replace(' ', '_')}.png" alt="${match.team1}">`;
            team2Logo.innerHTML = `<img src="logo/${match.team2.replace(' ', '_')}.png" alt="${match.team2}">`;
            
            team1Logo.className = 'team-logo';
            team2Logo.className = 'team-logo';
            
            document.getElementById('team1-name').textContent = match.team1;
            document.getElementById('team2-name').textContent = match.team2;
            document.getElementById('match-date').textContent = new Date(match.date).toLocaleDateString('en-US', { 
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            document.getElementById('match-time').textContent = match.time;
            document.getElementById('match-venue').textContent = match.venue;
            // document.getElementById('head-to-head').textContent = match.headToHead;
            
            // Get overall head-to-head data (all-time)
            const overallH2hKey = [match.team1, match.team2].sort().join('-');
            const overallH2hData = overallHeadToHead[overallH2hKey];
            
            // Update head-to-head display with overall statistics
            let h2hText = '';
            if (overallH2hData) {
                const team1Index = overallH2hKey.indexOf(match.team1) === 0 ? 0 : 1;
                const team1Wins = team1Index === 0 ? overallH2hData.team1Wins : overallH2hData.team2Wins;
                const team2Wins = team1Index === 0 ? overallH2hData.team2Wins : overallH2hData.team1Wins;
                
                h2hText = `Overall Head-to-Head: ${overallH2hData.matches} matches | ${match.team1} ${team1Wins} wins, ${match.team2} ${team2Wins} wins`;
                
                if (overallH2hData.noResult > 0) {
                    h2hText += `, ${overallH2hData.noResult} no result`;
                }
            } else {
                h2hText = 'No head-to-head data available';
            }
            
            document.getElementById('head-to-head').textContent = h2hText;

            // Show sections
            matchDetails.style.display = 'block';
            analysisBreakdown.style.display = 'block';
            weatherSelector.style.display = 'block';
            predictionResult.style.display = 'none';
            
            // Update analysis breakdown
            updateAnalysisBreakdown(match);
        }

        function generatePrediction() {
            const matchId = document.getElementById('match-select').value;
            const weather = document.getElementById('weather').value;
            
            if (!matchId) {
                alert('Please select a match first!');
                return;
            }

            document.getElementById('loading').style.display = 'block';
            document.getElementById('prediction-result').style.display = 'none';

            setTimeout(() => {
                const match = allMatches[matchId];
                const team1 = match.team1;
                const team2 = match.team2;
                const venue = match.venue;

                // Initialize scores
                let team1Score = 0;
                let team2Score = 0;

                // 1. Head-to-Head Performance (25% weight)
                const h2hScore = calculateHeadToHeadScore(team1, team2);
                team1Score += h2hScore.team1 * 0.25;
                team2Score += h2hScore.team2 * 0.25;

                // 2. Venue-Specific Analysis (20% weight)
                const venueScore = calculateVenueScore(team1, team2, venue);
                team1Score += venueScore.team1 * 0.20;
                team2Score += venueScore.team2 * 0.20;

                // 3. Current Tournament Form (35% weight)
                const formScore = calculateCurrentFormScore(team1, team2);
                team1Score += formScore.team1 * 0.35;
                team2Score += formScore.team2 * 0.35;

                // 4. Team Composition and Conditions (20% weight)
                const conditionsScore = calculateConditionsScore(team1, team2, weather, venue);
                team1Score += conditionsScore.team1 * 0.20;
                team2Score += conditionsScore.team2 * 0.20;

                // Normalize scores to percentages
                const totalScore = team1Score + team2Score;
                let team1Prob = Math.round((team1Score / totalScore) * 100);
                let team2Prob = Math.round((team2Score / totalScore) * 100);

                // Ensure total is 100%
                if (team1Prob + team2Prob !== 100) {
                    team2Prob = 100 - team1Prob;
                }

                const winner = team1Prob > team2Prob ? team1 : team2;
                const keyPlayers = {
                    "islamabad united": ["Shadab Khan", "Alex Hales", "Faheem Ashraf"],
                    "lahore qalandars": ["Shaheen Afridi", "Fakhar Zaman", "Haris Rauf"],
                    "karachi kings": ["Babar Azam", "Imad Wasim", "Mohammad Amir"],
                    "quetta gladiators": ["Mohammad Hasnain", "Jason Roy", "Mohammad Nawaz"],
                    "peshawar zalmi": ["Wahab Riaz", "Shoaib Malik", "Liam Livingstone"],
                    "multan sultans": ["Mohammad Rizwan", "Khushdil Shah", "Shahnawaz Dahani"]
                };

                const keyPlayer = keyPlayers[winner][Math.floor(Math.random() * 3)];
                const isClose = Math.abs(team1Prob - team2Prob) < 10;

                // Update prediction text
                document.getElementById('prediction-text').innerHTML = `
                    <strong>${winner} are favored to win${isClose ? ' in a close contest' : ''}</strong><br><br>
                    Our analysis shows a competitive match ahead${isClose ? ', with both teams evenly matched' : 
                    ', with one team having a clear advantage'}.
                `;

                // Update win probabilities
                document.getElementById('win-probability').innerHTML = `
                    ${team1}: ${team1Prob}%<br>
                    ${team2}: ${team2Prob}%
                `;

                // Update key player
                document.getElementById('key-player').textContent = keyPlayer;

                // Update expected score based on conditions and venue
                const venueData = pslData.venues[venue] || pslData.venues["Lahore"];
                const avgScore = (venueData.avgFirstInnings + venueData.avgSecondInnings) / 2;
                const weatherAdjustment = {
                    'Clear': 0,
                    'Cloudy': -5,
                    'Light Rain': -15,
                    'Hot and Humid': -5
                }[weather];
                
                const expectedAvg = avgScore + weatherAdjustment;
                const minScore = Math.round(expectedAvg - 10);
                const maxScore = Math.round(expectedAvg + 10);
                document.getElementById('expected-score').textContent = `${minScore}-${maxScore}`;

                // Update toss impact based on venue data
                document.getElementById('toss-impact').textContent = 
                    venueData.tossDecision.includes("field") ? "Teams prefer chasing at this venue" : 
                    "Teams prefer batting first at this venue";

                // Show Yoda quote
                const yodaQuotes = [
                    "Size matters not. The Force in cricket, strong it is.",
                    "Do or do not. There is no try in this match.",
                    "Difficult to see. Always in motion is the future of cricket.",
                    "Trust in the Force, and good cricket will follow.",
                    "Victory? Victory you say? Master cricket you must, to achieve it."
                ];
                document.getElementById('yoda-quote').textContent = 
                    yodaQuotes[Math.floor(Math.random() * yodaQuotes.length)];

                document.getElementById('loading').style.display = 'none';
                document.getElementById('prediction-result').style.display = 'block';
            }, 2000);
        }

        // Calculate head-to-head score
        function calculateHeadToHeadScore(team1, team2) {
            const overallH2hKey = [team1, team2].sort().join('-');
            const overallH2hData = overallHeadToHead[overallH2hKey];
            
            // PSL 2025 head-to-head
            const h2hKey = [team1, team2].sort().join('-');
            const h2hData = pslData.headToHead[h2hKey] || { total: 0, matches: [] };
            
            let team1Score = 50; // Base score
            let team2Score = 50; // Base score
            
            // Overall historical head-to-head (60% of h2h score)
            if (overallH2hData) {
                const team1Index = overallH2hKey.indexOf(team1) === 0 ? 0 : 1;
                const team1Wins = team1Index === 0 ? overallH2hData.team1Wins : overallH2hData.team2Wins;
                const team2Wins = team1Index === 0 ? overallH2hData.team2Wins : overallH2hData.team1Wins;
                
                if (overallH2hData.matches > 0) {
                    team1Score = (team1Wins / overallH2hData.matches) * 60;
                    team2Score = (team2Wins / overallH2hData.matches) * 60;
                }
            }
            
            // PSL 2025 head-to-head (40% of h2h score)
            if (h2hData.total > 0) {
                let team1PSLWins = 0;
                let team2PSLWins = 0;
                
                h2hData.matches.forEach(match => {
                    if (match.result.includes(team1) && match.result.includes("won")) {
                        team1PSLWins++;
                    } else if (match.result.includes(team2) && match.result.includes("won")) {
                        team2PSLWins++;
                    }
                });
                
                team1Score += (team1PSLWins / h2hData.total) * 40;
                team2Score += (team2PSLWins / h2hData.total) * 40;
            }
            
            return { team1: team1Score, team2: team2Score };
        }

        // Calculate venue-specific score
        function calculateVenueScore(team1, team2, venue) {
            const venueData = pslData.venues[venue] || pslData.venues["Lahore"];
            let team1Score = 50;
            let team2Score = 50;
            
            // Toss advantage (50% of venue score)
            const tossAdvantage = parseInt(venueData.winningToss) || 50;
            team1Score = tossAdvantage;
            team2Score = tossAdvantage;
            
            // Teams' previous performances at venue (50% of venue score)
            // This would require more specific venue data, so using a simplified approach
            const team1Data = pslData.teams[team1];
            const team2Data = pslData.teams[team2];
            
            team1Score += (team1Data.wins / team1Data.matches) * 50;
            team2Score += (team2Data.wins / team2Data.matches) * 50;
            
            return { team1: team1Score, team2: team2Score };
        }

        // Calculate current form score
        function calculateCurrentFormScore(team1, team2) {
            const team1Data = pslData.teams[team1];
            const team2Data = pslData.teams[team2];
            
            let team1Score = 0;
            let team2Score = 0;
            
            // Win percentage in PSL 2025 (40% of form score)
            team1Score += (team1Data.wins / team1Data.matches) * 40;
            team2Score += (team2Data.wins / team2Data.matches) * 40;
            
            // Recent form - last 5 matches (40% of form score)
            const team1RecentForm = team1Data.form.slice(-5);
            const team2RecentForm = team2Data.form.slice(-5);
            
            const team1RecentWins = (team1RecentForm.match(/W/g) || []).length;
            const team2RecentWins = (team2RecentForm.match(/W/g) || []).length;
            
            team1Score += (team1RecentWins / 5) * 40;
            team2Score += (team2RecentWins / 5) * 40;
            
            // Net run rate (20% of form score)
            const team1NRR = parseFloat(team1Data.nrr) || 0;
            const team2NRR = parseFloat(team2Data.nrr) || 0;
            
            // Normalize NRR to a 0-100 scale
            const maxNRR = Math.max(Math.abs(team1NRR), Math.abs(team2NRR), 1);
            team1Score += ((team1NRR + maxNRR) / (2 * maxNRR)) * 20;
            team2Score += ((team2NRR + maxNRR) / (2 * maxNRR)) * 20;
            
            return { team1: team1Score, team2: team2Score };
        }

        // Calculate conditions score
        function calculateConditionsScore(team1, team2, weather, venue) {
            let team1Score = 50;
            let team2Score = 50;
            
            // Key player availability (40% of conditions score)
            // Assuming all players are available for now
            team1Score += 20;
            team2Score += 20;
            
            // Team balance (30% of conditions score)
            // Using win percentage as a proxy for team balance
            const team1Data = pslData.teams[team1];
            const team2Data = pslData.teams[team2];
            
            team1Score += (team1Data.wins / team1Data.matches) * 15;
            team2Score += (team2Data.wins / team2Data.matches) * 15;
            
            // Weather conditions (30% of conditions score)
            const weatherAdvantage = {
                'Clear': { fast: 0, spin: 0 },
                'Cloudy': { fast: 10, spin: -5 },
                'Light Rain': { fast: 15, spin: -10 },
                'Hot and Humid': { fast: -5, spin: 10 }
            }[weather];
            
            // Assign advantage based on team strengths (simplified)
            const teamStrengths = {
                "islamabad united": "balanced",
                "lahore qalandars": "fast",
                "karachi kings": "balanced",
                "quetta gladiators": "spin",
                "peshawar zalmi": "fast",
                "multan sultans": "spin"
            };
            
            if (teamStrengths[team1] === "fast") team1Score += weatherAdvantage.fast;
            if (teamStrengths[team1] === "spin") team1Score += weatherAdvantage.spin;
            if (teamStrengths[team2] === "fast") team2Score += weatherAdvantage.fast;
            if (teamStrengths[team2] === "spin") team2Score += weatherAdvantage.spin;
            
            return { team1: team1Score, team2: team2Score };
        }

        // Function to update additional match-specific data
        function updateAdditionalMatchData(team1, team2, venue) {
            // Additional updates for the specific match can be added here
            // This function can be expanded to include more match-specific data
            console.log(`Additional data updated for ${team1} vs ${team2} at ${venue}`);
        }

        // Tab switching functionality
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('tab-button')) {
                // Remove active class from all tabs and contents
                document.querySelectorAll('.tab-button').forEach(tab => tab.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                
                // Add active class to clicked tab and corresponding content
                e.target.classList.add('active');
                const tabId = e.target.getAttribute('data-tab');
                document.getElementById(tabId).classList.add('active');
            }
        });

        // Overall PSL head-to-head data (all-time)
        const overallHeadToHead = {
            "islamabad united-quetta gladiators": {
                matches: 20,
                team1Wins: 10,
                team2Wins: 9,
                noResult: 1
            },
            "karachi kings-lahore qalandars": {
                matches: 19,
                team1Wins: 13,
                team2Wins: 6,
                noResult: 0
            },
            "multan sultans-peshawar zalmi": {
                matches: 16,
                team1Wins: 11,
                team2Wins: 5,
                noResult: 0
            },
            "karachi kings-peshawar zalmi": {
                matches: 21,
                team1Wins: 6,
                team2Wins: 15,
                noResult: 0
            },
            "lahore qalandars-peshawar zalmi": {
                matches: 19,
                team1Wins: 8,
                team2Wins: 11,
                noResult: 0
            },
            "islamabad united-multan sultans": {
                matches: 16,
                team1Wins: 8,
                team2Wins: 8,
                noResult: 0
            },
            "karachi kings-quetta gladiators": {
                matches: 18,
                team1Wins: 6,
                team2Wins: 12,
                noResult: 0
            },
            "lahore qalandars-multan sultans": {
                matches: 19,
                team1Wins: 9,
                team2Wins: 10,
                noResult: 0
            },
            "islamabad united-peshawar zalmi": {
                matches: 24,
                team1Wins: 12,
                team2Wins: 12,
                noResult: 0
            },
            "quetta gladiators-multan sultans": {
                matches: 13,
                team1Wins: 4,
                team2Wins: 9,
                noResult: 0
            }
        };

        // PSL 2025 comprehensive match data
        const pslData = {
            teams: {
                "islamabad united": {
                    matches: 8,
                    wins: 6,
                    losses: 2,
                    points: 12,
                    nrr: "+1.285",
                    form: "WWWWWLLW",
                    recentMatches: [
                        { opponent: "peshawar zalmi", result: "Lost by 6 wickets", date: "2025-05-02" },
                        { opponent: "lahore qalandars", result: "Lost by 88 runs", date: "2025-04-30" },
                        { opponent: "lahore qalandars", result: "Lost by 5 wickets", date: "2025-04-26" },
                        { opponent: "multan sultans", result: "Won by 7 wickets", date: "2025-04-23" },
                        { opponent: "karachi kings", result: "Won by 6 wickets", date: "2025-04-20" }
                    ]
                },
                "lahore qalandars": {
                    matches: 8,
                    wins: 5,
                    losses: 2,
                    points: 11,
                    nrr: "+0.635",
                    form: "WLWWWLW",
                    recentMatches: [
                        { opponent: "quetta gladiators", result: "No result (Rain)", date: "2025-05-01" },
                        { opponent: "islamabad united", result: "Won by 88 runs", date: "2025-04-30" },
                        { opponent: "islamabad united", result: "Won by 5 wickets", date: "2025-04-26" },
                        { opponent: "peshawar zalmi", result: "Lost by 7 wickets", date: "2025-04-24" },
                        { opponent: "multan sultans", result: "Lost by 33 runs", date: "2025-04-22" }
                    ]
                },
                "karachi kings": {
                    matches: 8,
                    wins: 4,
                    losses: 4,
                    points: 8,
                    nrr: "-0.148",
                    form: "WLWLWWLW",
                    recentMatches: [
                        { opponent: "multan sultans", result: "Won by 87 runs", date: "2025-05-01" },
                        { opponent: "quetta gladiators", result: "Lost by 5 runs", date: "2025-04-25" },
                        { opponent: "peshawar zalmi", result: "Won by 2 wickets", date: "2025-04-21" },
                        { opponent: "islamabad united", result: "Lost by 6 wickets", date: "2025-04-20" },
                        { opponent: "quetta gladiators", result: "Won by 56 runs", date: "2025-04-18" }
                    ]
                },
                "quetta gladiators": {
                    matches: 8,
                    wins: 4,
                    losses: 3,
                    points: 9,
                    nrr: "+0.245",
                    form: "LWLWWWW",
                    recentMatches: [
                        { opponent: "lahore qalandars", result: "No result (Rain)", date: "2025-05-01" },
                        { opponent: "multan sultans", result: "Won by 10 wickets", date: "2025-04-29" },
                        { opponent: "peshawar zalmi", result: "Won by 64 runs", date: "2025-04-27" },
                        { opponent: "karachi kings", result: "Won by 5 runs", date: "2025-04-25" },
                        { opponent: "karachi kings", result: "Lost by 56 runs", date: "2025-04-18" }
                    ]
                },
                "peshawar zalmi": {
                    matches: 8,
                    wins: 3,
                    losses: 5,
                    points: 6,
                    nrr: "-0.622",
                    form: "WLLWLLW",
                    recentMatches: [
                        { opponent: "islamabad united", result: "Won by 6 wickets", date: "2025-05-02" },
                        { opponent: "lahore qalandars", result: "Won by 7 wickets", date: "2025-04-24" },
                        { opponent: "quetta gladiators", result: "Lost by 64 runs", date: "2025-04-27" },
                        { opponent: "karachi kings", result: "Lost by 2 wickets", date: "2025-04-21" },
                        { opponent: "multan sultans", result: "Won by 120 runs", date: "2025-04-19" }
                    ]
                },
                "multan sultans": {
                    matches: 8,
                    wins: 1,
                    losses: 7,
                    points: 2,
                    nrr: "-1.387",
                    form: "LLLLWLLL",
                    recentMatches: [
                        { opponent: "karachi kings", result: "Lost by 87 runs", date: "2025-05-01" },
                        { opponent: "quetta gladiators", result: "Lost by 10 wickets", date: "2025-04-29" },
                        { opponent: "islamabad united", result: "Lost by 7 wickets", date: "2025-04-23" },
                        { opponent: "lahore qalandars", result: "Won by 33 runs", date: "2025-04-22" },
                        { opponent: "peshawar zalmi", result: "Lost by 120 runs", date: "2025-04-19" }
                    ]
                }
            },
            headToHead: {
                "multan sultans-peshawar zalmi": {
                    total: 1,
                    matches: [
                        { date: "2025-04-19", result: "peshawar zalmi won by 120 runs", scores: "PZ: 227/7, MS: 107 all out" }
                    ]
                },
                "islamabad united-lahore qalandars": {
                    total: 3,
                    matches: [
                        { date: "2025-04-30", result: "lahore qalandars won by 88 runs", scores: "LQ: 202/6, IU: 114 all out" },
                        { date: "2025-04-26", result: "lahore qalandars won by 5 wickets", scores: "IU: 185/6, LQ: 186/5" },
                        { date: "2025-04-11", result: "islamabad united won by 8 wickets", scores: "LQ: 139/10, IU: 143/2" }
                    ]
                },
                "karachi kings-multan sultans": {
                    total: 2,
                    matches: [
                        { date: "2025-05-01", result: "karachi kings won by 87 runs", scores: "KK: 201/5, MS: 114 all out" },
                        { date: "2025-04-12", result: "karachi kings won by 4 wickets", scores: "MS: 234/3, KK: 236/6" }
                    ]
                },
                "peshawar zalmi-quetta gladiators": {
                    total: 2,
                    matches: [
                        { date: "2025-04-27", result: "quetta gladiators won by 64 runs", scores: "QG: 182/5, PZ: 118 all out" },
                        { date: "2025-04-12", result: "quetta gladiators won by 80 runs", scores: "QG: 216/3, PZ: 136 all out" }
                    ]
                },
                "karachi kings-lahore qalandars": {
                    total: 1,
                    matches: [
                        { date: "2025-04-15", result: "lahore qalandars won by 65 runs", scores: "LQ: 226/4, KK: 161 all out" }
                    ]
                },
                "islamabad united-multan sultans": {
                    total: 2,
                    matches: [
                        { date: "2025-04-23", result: "islamabad united won by 7 wickets", scores: "MS: 148/8, IU: 149/3" },
                        { date: "2025-04-16", result: "islamabad united won by 47 runs", scores: "IU: 184/5, MS: 137 all out" }
                    ]
                },
                "karachi kings-quetta gladiators": {
                    total: 2,
                    matches: [
                        { date: "2025-04-25", result: "quetta gladiators won by 5 runs", scores: "QG: 170/7, KK: 165/8" },
                        { date: "2025-04-18", result: "karachi kings won by 56 runs", scores: "KK: 205/6, QG: 149 all out" }
                    ]
                },
                "lahore qalandars-peshawar zalmi": {
                    total: 1,
                    matches: [
                        { date: "2025-04-24", result: "peshawar zalmi won by 7 wickets", scores: "LQ: 172/6, PZ: 173/3" }
                    ]
                },
                "islamabad united-karachi kings": {
                    total: 1,
                    matches: [
                        { date: "2025-04-20", result: "islamabad united won by 6 wickets", scores: "KK: 165/7, IU: 166/4" }
                    ]
                },
                "karachi kings-peshawar zalmi": {
                    total: 1,
                    matches: [
                        { date: "2025-04-21", result: "karachi kings won by 2 wickets", scores: "PZ: 178/6, KK: 179/8" }
                    ]
                },
                "lahore qalandars-multan sultans": {
                    total: 1,
                    matches: [
                        { date: "2025-04-22", result: "multan sultans won by 33 runs", scores: "MS: 195/5, LQ: 162 all out" }
                    ]
                },
                "islamabad united-peshawar zalmi": {
                    total: 2,
                    matches: [
                        { date: "2025-05-02", result: "peshawar zalmi won by 6 wickets", scores: "IU: 163/7, PZ: 164/4" },
                        { date: "2025-04-14", result: "islamabad united won by 102 runs", scores: "IU: 254/4, PZ: 152 all out" }
                    ]
                },
                "multan sultans-quetta gladiators": {
                    total: 1,
                    matches: [
                        { date: "2025-04-29", result: "quetta gladiators won by 10 wickets", scores: "MS: 89 all out, QG: 90/0" }
                    ]
                },
                "lahore qalandars-quetta gladiators": {
                    total: 2,
                    matches: [
                        { date: "2025-05-01", result: "No result (Rain)", scores: "Match abandoned" },
                        { date: "2025-04-13", result: "lahore qalandars won by 79 runs", scores: "LQ: 242/5, QG: 163 all out" }
                    ]
                },
                "islamabad united-quetta gladiators": {
                    total: 0,
                    matches: []
                }
            },
            venues: {
                "Lahore": {
                    matches: 11,
                    avgFirstInnings: 185,
                    avgSecondInnings: 162,
                    tossDecision: "72% elected to field first",
                    winningToss: "59% matches won by team winning toss"
                },
                "Karachi": {
                    matches: 5,
                    avgFirstInnings: 198,
                    avgSecondInnings: 184,
                    tossDecision: "80% elected to field first",
                    winningToss: "60% matches won by team winning toss"
                },
                "Multan": {
                    matches: 4,
                    avgFirstInnings: 168,
                    avgSecondInnings: 152,
                    tossDecision: "64% elected to field first",
                    winningToss: "52% matches won by team winning toss"
                },
                "Rawalpindi": {
                    matches: 4,
                    avgFirstInnings: 198,
                    avgSecondInnings: 178,
                    tossDecision: "75% elected to field first",
                    winningToss: "50% matches won by team winning toss"
                }
            }
        };

        // Function to update analysis breakdown
        function updateAnalysisBreakdown(match) {
            const team1 = match.team1;
            const team2 = match.team2;
            const venue = match.venue;

            // Get team data
            const team1Data = pslData.teams[team1];
            const team2Data = pslData.teams[team2];

            // Get head-to-head data
            const h2hKey = [team1, team2].sort().join('-');
            const h2hData = pslData.headToHead[h2hKey] || { total: 0, matches: [] };

            // Calculate wins for each team
            let team1Wins = 0;
            let team2Wins = 0;
            
            if (h2hData.matches && h2hData.matches.length > 0) {
                h2hData.matches.forEach(match => {
                    if (match.result.includes(team1) && match.result.includes("won")) {
                        team1Wins++;
                    } else if (match.result.includes(team2) && match.result.includes("won")) {
                        team2Wins++;
                    }
                });
            }

            // Get venue data
            const venueData = pslData.venues[venue] || pslData.venues["Lahore"]; // Default to Lahore if venue not found

            // Update Key Factors tab
            document.getElementById('h2h-current-season').innerHTML = `<span style="color: #2B6735;">${team1} won ${team1Wins}, ${team2} won ${team2Wins}</span>`;
            document.getElementById('toss-advantage').innerHTML = `<span style="color: #B27F35;">${venueData.winningToss}</span>`;
            document.getElementById('win-percentage').innerHTML = `<span style="color: #2B6735;">${team1}: ${(team1Data.wins/team1Data.matches*100).toFixed(1)}% | ${team2}: ${(team2Data.wins/team2Data.matches*100).toFixed(1)}%</span>`;
            document.getElementById('venue-performance').innerHTML = `<span style="color: #2B6735;">See venue analysis tab for details</span>`;
            document.getElementById('recent-form').innerHTML = `<span style="color: #B27F35;">${team1}: ${team1Data.form.slice(-5)} | ${team2}: ${team2Data.form.slice(-5)}</span>`;
            document.getElementById('key-players-status').innerHTML = `<span style="color: #2B6735;">All players available unless otherwise noted</span>`;

            // Update Venue Analysis tab
            document.getElementById('venue-name').textContent = `${venue} Cricket Stadium Stats`;
            document.getElementById('avg-first-innings').innerHTML = `<span style="color: #B27F35;">${venueData.avgFirstInnings} runs</span>`;
            document.getElementById('avg-second-innings').innerHTML = `<span style="color: #B27F35;">${venueData.avgSecondInnings} runs</span>`;
            document.getElementById('toss-decision-trend').innerHTML = `<span style="color: #B27F35;">${venueData.tossDecision}</span>`;
            document.getElementById('team1-venue-record').innerHTML = `<span style="color: #2B6735;">Check team performance at venue</span>`;
            document.getElementById('team2-venue-record').innerHTML = `<span style="color: #2B6735;">Check team performance at venue</span>`;

            // Update Current Form tab
            document.getElementById('team1-form-title').textContent = `${team1} - Recent Form`;
            document.getElementById('team2-form-title').textContent = `${team2} - Recent Form`;

            // Generate form HTML for team 1
            let team1FormHtml = '';
            if (team1Data && team1Data.recentMatches) {
                team1Data.recentMatches.forEach(match => {
                    const resultClass = match.result.includes('Won') ? 'win' : match.result.includes('Lost') ? 'loss' : '';
                    const resultText = match.result.includes('Won') ? 'win' : match.result.includes('Lost') ? 'loss' : '';
                    team1FormHtml += `
                        <div class="form-match ${resultClass}">
                            <span>vs ${match.opponent} (${match.date})</span>
                            <span class="result ${resultText}">${match.result}</span>
                        </div>
                    `;
                });
            }

            // Generate form HTML for team 2
            let team2FormHtml = '';
            if (team2Data && team2Data.recentMatches) {
                team2Data.recentMatches.forEach(match => {
                    const resultClass = match.result.includes('Won') ? 'win' : match.result.includes('Lost') ? 'loss' : '';
                    const resultText = match.result.includes('Won') ? 'win' : match.result.includes('Lost') ? 'loss' : '';
                    team2FormHtml += `
                        <div class="form-match ${resultClass}">
                            <span>vs ${match.opponent} (${match.date})</span>
                            <span class="result ${resultText}">${match.result}</span>
                        </div>
                    `;
                });
            }

            document.getElementById('team1-recent-form').innerHTML = team1FormHtml;
            document.getElementById('team2-recent-form').innerHTML = team2FormHtml;

            // Update additional match data
            updateAdditionalMatchData(team1, team2, venue);
        }

        // Initialize when page loads
        window.onload = function() {
            populateMatchSelector();
            
            // Add event listeners
            document.getElementById('match-select').addEventListener('change', function() {
                showMatchDetails(this.value);
            });
            document.getElementById('predict-btn').addEventListener('click', generatePrediction);
        };
    </script>
</body>
</html>